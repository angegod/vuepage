import{_ as te,k as v,o as i,c as r,a as e,b as le,w as O,T as D,d as m,n as $,F as S,f as C,t as b,g as ne,p as ae,h as de}from"./index-7ceb4a34.js";import{a as L}from"./axios-1779699b.js";const c=y=>(ae("data-v-c51c8a69"),y=y(),de(),y),oe={class:"main"},se={class:"mx-auto w-4/5"},ie=c(()=>e("div",null,[e("span",{class:"text-red-500 text-2xl font-bold"},"技能管理")],-1)),ce={class:"flex flex-row"},ue={class:"max-h-[600px] overflow-y-scroll w-1/3",id:"skill"},ve={class:"flex flex-row sticky top-2 bg-black"},re={class:"text-amber-800 text-lg font-bold pl-3"},me=["onClick"],pe=["onClick"],fe={class:"flex flex-col"},_e={class:"text-white h-[30px] flex items-center"},ye=["onClick"],he=["onClick"],xe={class:"w-2/3 pl-5"},ge={key:0},Ie=c(()=>e("div",null,[e("span",{class:"text-red-500 font-bold text-lg"},"新增技能")],-1)),be={class:"flex flex-col"},Be=c(()=>e("div",{class:"flex flex-row mt-2 mb-2"},[e("span",{class:"text-white"},"技能簡短敘述:"),e("input",{type:"text",placeholder:"技能敘述",class:"rounded bg-gray-600 text-white",id:"input1"})],-1)),ke={class:"flex flex-row mb-2 mt-2"},we=c(()=>e("span",{class:"text-white"},"技能插入位置:",-1)),Se=["max"],Ce=c(()=>e("div",null,[e("span",{class:"text-red-300"},b("*技能將會添加至指定系列位置"))],-1)),Ee={key:1},Pe=c(()=>e("div",null,[e("span",{class:"text-red-500 font-bold text-lg"},"修改技能標籤設定")],-1)),Ne={class:"mt-5 mb-5"},Te=c(()=>e("span",{class:"text-white font-bold"},"修改技能名稱",-1)),Me=c(()=>e("br",null,null,-1)),Fe=["value"],Je={class:"mt-5 mb-5"},Oe=c(()=>e("span",{class:"text-white font-bold"},"歸屬於",-1)),De=["value","selected"],$e={class:"mt-5 mb-5"},Le=c(()=>e("span",{class:"text-white font-bold"},"擺放位置",-1)),Ve={class:"flex flex-row"},Ae=["value","max"],Ge={__name:"ModifyFunc",setup(y){let l=v([]),u=v(""),f=[],p=v(0),B=v(0),h=v(null),_=v(null),k=v(null),x=v(1),w=v(1);L.post("http://localhost:5000/func/get").then(t=>{f=t.data.func,l.value=JSON.parse(JSON.stringify(f)),E()});function E(){f.forEach(t=>{w.value+=1,t.data.forEach(a=>{x.value+=1})}),console.log(x.value)}function V(t){if(t.key=="Enter"){let a={typeId:w.value,typeName:t.target.value,data:[]};l.value.push(a),console.log(l.value),g(),w.value+=1;let n=document.getElementById("skill");n.scrollTo(0,n.scrollHeight)}}function A(){l.value=JSON.parse(JSON.stringify(f)),E()}function G(t){p.value=t,u.value="add",_.value=l.value.find(a=>a.typeId==p.value).data.length+1}function H(){let t=document.getElementById("input1").value,a=document.getElementById("addPos").value,n={id:x.value,name:t};console.log(l.value.find(d=>d.typeId===p.value)),l.value.find(d=>d.typeId===p.value).data.splice(a-1,0,n),alert("技能標籤已加入"),g(),x.value+=1}function K(t,a){u.value="edit",p.value=t,B.value=a;let n=l.value.find(o=>o.typeId===t).data.find(o=>o.id===a),d=l.value.find(o=>o.typeId===t).data.findIndex(o=>o.id===a);_.value=l.value.find(o=>o.typeId===t).data.length+1,k.value=n,h.value=d}function R(t,a){let n=l.value.find(d=>d.typeId===t);n.data=n.data.filter(d=>d.id!==a)}function j(){let t={id:B.value,name:document.getElementById("editname").value};function a(o,X,M,Y,Z){let ee=l.value.find(s=>s.typeId===o).data.find((s,J)=>J===X),F=l.value.find(s=>s.typeId==M).data;ee.delete=!0,F.splice(Y,0,Z),l.value.find(s=>s.typeId==M).data=F,console.log(l.value);let I=l.value.find(s=>s.typeId===o).data;I=I.filter((s,J)=>s.delete!==!0),console.log(I),l.value.find(s=>s.typeId===o).data=I}let n=p.value,d=document.getElementById("beyond").value;a(n,h.value,d,document.getElementById("editPos").value-1,t),console.log(l.value),alert("修改位置完畢!!"),g()}function P(){alert("取消操作"),g()}function q(t){confirm(`確定刪除這個系列嗎?如果誤刪可以透過還原恢復
但如果送出儲存成功則無法恢復
確定刪除嗎?`)&&(l.value=l.value.filter(n=>n.typeId!==t),alert("刪除成功!!")),console.log(l.value)}function z(){let t=parseInt(document.getElementById("beyond").value);document.getElementById("editPos").max=l.value.find(a=>a.typeId===t).data.length+1,document.getElementById("editPos").value=1}function N(){if(u.value==="edit")document.getElementById("editPos").value=parseInt(document.getElementById("editPos").min);else if(u.value==="add")document.getElementById("addPos").value=parseInt(document.getElementById("addPos").min);else return}function T(){if(u.value==="edit")document.getElementById("editPos").value=parseInt(document.getElementById("editPos").max);else if(u.value==="add")document.getElementById("addPos").value=parseInt(document.getElementById("addPos").max);else return}function Q(t){t.target.classList.remove("hideBtn")}function U(t){t.target.classList.add("hideBtn")}function g(){p.value=0,B.value=0,h.value=null,_.value=null,k.value=null,u.value=""}function W(){let t={func:l.value};console.log(t),L.post("http://localhost:5000/func/save",t).then(async a=>{alert(a.data.msg),f=JSON.parse(JSON.stringify(l.value)),console.log(a.data)})}return(t,a)=>(i(),r("div",oe,[e("div",se,[ie,e("div",null,[e("input",{type:"text",class:"rounded bg-gray-600 text-white",placeholder:"技能系列名稱",onKeydown:V},null,32),e("button",{class:"addBtn",onClick:A},"還原"),e("button",{class:"addBtn",onClick:W},"送出")]),e("div",ce,[e("div",ue,[le(D,{tag:"div",name:"type"},{default:O(()=>[(i(!0),r(S,null,C(m(l),n=>(i(),r("div",{class:"mt-5 mb-5",key:"type"+n.id},[e("div",ve,[e("span",re,b(n.typeName),1),e("button",{class:"addBtn",onClick:d=>G(n.typeId)},"添加技能",8,me),e("button",{class:"addBtn",onClick:d=>q(n.typeId)},"刪除",8,pe)]),e("div",fe,[(i(),ne(D,{tag:"div",name:"list",key:n},{default:O(()=>[(i(!0),r(S,null,C(n.data,d=>(i(),r("div",{class:"flex flex-row hideBtn mt-1 mb-1",key:d,onMouseenter:Q,onMouseleave:U},[e("span",_e,b(d.id+" "+d.name),1),e("button",{class:"addBtn",onClick:o=>K(n.typeId,d.id)},"修改",8,ye),e("button",{class:"removeBtn",onClick:o=>R(n.typeId,d.id)},"刪除",8,he)],32))),128))]),_:2},1024))])]))),128))]),_:1})]),e("div",xe,[m(u)==="add"?(i(),r("div",ge,[e("div",null,[Ie,e("div",be,[Be,e("div",ke,[we,e("input",{type:"number",placeholder:"變動位置",class:"rounded bg-gray-600 text-white",id:"addPos",min:1,max:m(_)},null,8,Se),e("button",{class:"addBtn index",onClick:N},"最前面"),e("button",{class:"addBtn index",onClick:T},"最後面")]),e("div",null,[e("button",{class:"addBtn",onClick:H},"新增"),e("button",{class:"addBtn",onClick:P},"取消")])]),Ce])])):$("",!0),m(u)==="edit"?(i(),r("div",Ee,[Pe,e("div",Ne,[Te,Me,e("input",{type:"text",value:m(k).name,placeholder:"技能描述",class:"rounded bg-gray-600 text-white",id:"editname"},null,8,Fe)]),e("div",Je,[Oe,e("div",null,[e("select",{class:"colorSelect",id:"beyond",onChange:z},[(i(!0),r(S,null,C(m(l),n=>(i(),r("option",{value:n.typeId,selected:n.typeId===m(p)},b(n.typeName),9,De))),256))],32)])]),e("div",$e,[Le,e("div",Ve,[e("input",{type:"number",value:m(h)+1,min:1,max:m(_),id:"editPos"},null,8,Ae),e("button",{class:"addBtn index",onClick:N},"最前面"),e("button",{class:"addBtn index",onClick:T},"最後面")])]),e("div",{class:"flex flex-row mt-10"},[e("button",{class:"addBtn",onClick:j},"儲存變更"),e("button",{class:"addBtn",onClick:P},"取消操作")])])):$("",!0)])])])]))}},Re=te(Ge,[["__scopeId","data-v-c51c8a69"]]);export{Re as default};
