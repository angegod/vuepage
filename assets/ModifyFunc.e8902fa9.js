import{_ as le,j as i,o as c,c as r,a as e,b as ae,w as D,P as $,d as m,m as L,F as C,f as E,t as w,I as ne,p as de,g as oe}from"./index.27c9de89.js";import{a as V}from"./axios.7738e096.js";const u=g=>(de("data-v-6edcaf74"),g=g(),oe(),g),se={class:"main"},ie={class:"mx-auto w-4/5"},ce=u(()=>e("div",null,[e("span",{class:"text-red-500 text-2xl font-bold"},"技能管理")],-1)),ue={class:"flex flex-row"},ve={class:"max-h-[450px] overflow-y-scroll w-1/3",id:"skill"},re={class:"flex flex-row sticky top-2 bg-black"},me={class:"text-amber-800 text-lg font-bold pl-3"},pe=["onClick"],fe=["onClick"],_e={class:"flex flex-col"},he={class:"text-white h-[30px] flex items-center"},ye=["onClick"],ge=["onClick"],xe={class:"w-2/3 pl-5"},Ie={key:0},be=u(()=>e("div",null,[e("span",{class:"text-red-500 font-bold text-lg"},"新增技能")],-1)),Be={class:"flex flex-col"},we=u(()=>e("div",{class:"flex flex-row mt-2 mb-2"},[e("span",{class:"text-white"},"技能簡短敘述:"),e("input",{type:"text",placeholder:"技能敘述",class:"rounded bg-gray-600 text-white",id:"input1"})],-1)),ke={class:"flex flex-row mb-2 mt-2"},Se=u(()=>e("span",{class:"text-white"},"技能插入位置:",-1)),Ce=["max"],Ee=u(()=>e("div",null,[e("span",{class:"text-red-300"},w("*技能將會添加至指定系列位置"))],-1)),Pe={key:1},Ne=u(()=>e("div",null,[e("span",{class:"text-red-500 font-bold text-lg"},"修改技能標籤設定")],-1)),Te={class:"mt-5 mb-5"},Me=u(()=>e("span",{class:"text-white font-bold"},"修改技能名稱",-1)),Fe=u(()=>e("br",null,null,-1)),Je=["value"],Oe={class:"mt-5 mb-5"},De=u(()=>e("span",{class:"text-white font-bold"},"歸屬於",-1)),$e=["value","selected"],Le={class:"mt-5 mb-5"},Ve=u(()=>e("span",{class:"text-white font-bold"},"擺放位置",-1)),je={class:"flex flex-row"},Ae=["value","max"],Ge={__name:"ModifyFunc",setup(g){let l=i([]),v=i(""),_=[],p=i(0),k=i(0),x=i(null),h=i(null),S=i(null),I=i(1),y=i(1),f=i([]);V.post("http://localhost:5000/func/get").then(t=>{_=t.data.func,l.value=JSON.parse(JSON.stringify(_)),P()});function P(){_.forEach(t=>{y.value+=1,t.data.forEach(n=>{I.value+=1})}),console.log(I.value)}function j(t){if(t.key=="Enter"){let n={typeId:y.value,typeName:t.target.value,data:[]};l.value.push(n),console.log(l.value);let a={method:"addSeries",data:{typeId:y.value,typeName:t.target.value}};f.value.push(a),b(),y.value+=1;let d=document.getElementById("skill");d.scrollTo(0,d.scrollHeight)}}function A(){l.value=JSON.parse(JSON.stringify(_)),f.value=[],P()}function G(t){p.value=t,v.value="add",h.value=l.value.find(n=>n.typeId==p.value).data.length+1}function H(){let t=document.getElementById("input1").value,n=document.getElementById("addPos").value,a={id:I.value,name:t};console.log(l.value.find(d=>d.typeId===p.value)),l.value.find(d=>d.typeId===p.value).data.splice(n-1,0,a),alert("技能標籤已加入"),b(),I.value+=1}function K(t,n){v.value="edit",p.value=t,k.value=n;let a=l.value.find(o=>o.typeId===t).data.find(o=>o.id===n),d=l.value.find(o=>o.typeId===t).data.findIndex(o=>o.id===n);h.value=l.value.find(o=>o.typeId===t).data.length+1,S.value=a,x.value=d}function R(t,n){let a=l.value.find(o=>o.typeId===t);a.data=a.data.filter(o=>o.id!==n);let d={method:"deleteTag",data:{type:t,id:n}};f.value.push(d),console.log(f)}function q(){let t={id:k.value,name:document.getElementById("editname").value};function n(o,Y,F,Z,ee){let te=l.value.find(s=>s.typeId===o).data.find((s,O)=>O===Y),J=l.value.find(s=>s.typeId==F).data;te.delete=!0,J.splice(Z,0,ee),l.value.find(s=>s.typeId==F).data=J,console.log(l.value);let B=l.value.find(s=>s.typeId===o).data;B=B.filter((s,O)=>s.delete!==!0),console.log(B),l.value.find(s=>s.typeId===o).data=B}let a=p.value,d=document.getElementById("beyond").value;n(a,x.value,d,document.getElementById("editPos").value-1,t),console.log(l.value),alert("修改位置完畢!!"),b()}function N(){alert("取消操作"),b()}function z(t){if(confirm(`確定刪除這個系列嗎?如果誤刪可以透過還原恢復
但如果送出儲存成功則無法恢復
確定刪除嗎?`)){l.value=l.value.filter(d=>d.typeId!==t),alert("刪除成功!!"),y.value-=1;let a={method:"deleteSeries",data:{typeId:t}};f.value.push(a)}console.log(l.value)}function Q(){let t=parseInt(document.getElementById("beyond").value);document.getElementById("editPos").max=l.value.find(n=>n.typeId===t).data.length+1,document.getElementById("editPos").value=1}function T(){if(v.value==="edit")document.getElementById("editPos").value=parseInt(document.getElementById("editPos").min);else if(v.value==="add")document.getElementById("addPos").value=parseInt(document.getElementById("addPos").min);else return}function M(){if(v.value==="edit")document.getElementById("editPos").value=parseInt(document.getElementById("editPos").max);else if(v.value==="add")document.getElementById("addPos").value=parseInt(document.getElementById("addPos").max);else return}function U(t){t.target.classList.remove("hideBtn")}function W(t){t.target.classList.add("hideBtn")}function b(){p.value=0,k.value=0,x.value=null,h.value=null,S.value=null,v.value=""}function X(){let t={func:l.value,moves:f.value};console.log(t),V.post("http://localhost:5000/func/save",t).then(async n=>{alert(n.data.msg),_=JSON.parse(JSON.stringify(l.value)),console.log(n.data),f.value=[]}).catch(n=>{alert("伺服器尚未開啟請稍後再試!!"),window.location=window.location.origin+"/vuepage/"})}return(t,n)=>(c(),r("div",se,[e("div",ie,[ce,e("div",null,[e("input",{type:"text",class:"rounded bg-gray-600 text-white",placeholder:"技能系列名稱",onKeydown:j},null,32),e("button",{class:"addBtn",onClick:A},"還原"),e("button",{class:"addBtn",onClick:X},"送出")]),e("div",ue,[e("div",ve,[ae($,{tag:"div",name:"type"},{default:D(()=>[(c(!0),r(C,null,E(m(l),a=>(c(),r("div",{class:"mt-5 mb-5",key:"type"+a.id},[e("div",re,[e("span",me,w(a.typeName),1),e("button",{class:"addBtn",onClick:d=>G(a.typeId)},"添加技能",8,pe),e("button",{class:"addBtn",onClick:d=>z(a.typeId)},"刪除",8,fe)]),e("div",_e,[(c(),ne($,{tag:"div",name:"list",key:a},{default:D(()=>[(c(!0),r(C,null,E(a.data,d=>(c(),r("div",{class:"flex flex-row hideBtn mt-1 mb-1",key:d,onMouseenter:U,onMouseleave:W},[e("span",he,w(d.id+" "+d.name),1),e("button",{class:"addBtn",onClick:o=>K(a.typeId,d.id)},"修改",8,ye),e("button",{class:"removeBtn",onClick:o=>R(a.typeId,d.id)},"刪除",8,ge)],32))),128))]),_:2},1024))])]))),128))]),_:1})]),e("div",xe,[m(v)==="add"?(c(),r("div",Ie,[e("div",null,[be,e("div",Be,[we,e("div",ke,[Se,e("input",{type:"number",placeholder:"變動位置",class:"rounded bg-gray-600 text-white",id:"addPos",min:1,max:m(h)},null,8,Ce),e("button",{class:"addBtn index",onClick:T},"最前面"),e("button",{class:"addBtn index",onClick:M},"最後面")]),e("div",null,[e("button",{class:"addBtn",onClick:H},"新增"),e("button",{class:"addBtn",onClick:N},"取消")])]),Ee])])):L("",!0),m(v)==="edit"?(c(),r("div",Pe,[Ne,e("div",Te,[Me,Fe,e("input",{type:"text",value:m(S).name,placeholder:"技能描述",class:"rounded bg-gray-600 text-white",id:"editname"},null,8,Je)]),e("div",Oe,[De,e("div",null,[e("select",{class:"colorSelect",id:"beyond",onChange:Q},[(c(!0),r(C,null,E(m(l),a=>(c(),r("option",{value:a.typeId,selected:a.typeId===m(p)},w(a.typeName),9,$e))),256))],32)])]),e("div",Le,[Ve,e("div",je,[e("input",{type:"number",value:m(x)+1,min:1,max:m(h),id:"editPos"},null,8,Ae),e("button",{class:"addBtn index",onClick:T},"最前面"),e("button",{class:"addBtn index",onClick:M},"最後面")])]),e("div",{class:"flex flex-row mt-10"},[e("button",{class:"addBtn",onClick:q},"儲存變更"),e("button",{class:"addBtn",onClick:N},"取消操作")])])):L("",!0)])])])]))}},Re=le(Ge,[["__scopeId","data-v-6edcaf74"]]);export{Re as default};
