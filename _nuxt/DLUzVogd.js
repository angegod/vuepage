import{_ as ce,r as _,c as o,o as a,b as R,w as ee,f as p,u as s,a as e,t as x,F as b,p as h,g as Q,G as Z,T as ve,m as xe,l as ge,j as re,i as we,H as be,s as he,v as ye}from"./_vJm55SO.js";import{a as O}from"./Dq7h7Pqt.js";import _e from"./BWJKEaMP.js";import ke from"./CFY3RD-E.js";import{N as $e,P as Ce,S as fe,C as me}from"./CXnie5qI.js";const Ee={class:"h-[450px] pl-5"},Ie={class:"flex flex-row min-w-[500px]",key:"step1"},Be={class:"pl-2 pr-2 w-1/2"},Se={class:"flex flex-col"},Ne={class:"mt-3 flex flex-row items-baseline"},je={class:"flex flex-col mt-5"},De=["value"],Pe={class:"flex flex-col mt-5"},Fe=["src"],Le={class:"pl-2 pr-2 w-1/2 flex flex-col justify-between"},Te={class:"flex flex-col"},Ke=["src"],Oe={key:"step2",class:"flex flex-row min-w-[500px]"},Je={class:"w-1/2 pl-2 pr-2 flex flex-col"},Me={class:"flex flex-col"},Ue={class:"flex flex-row mb-1"},Ve=["onUpdate:modelValue"],Ae={class:"flex flex-col mt-5"},Ge={class:"flex flex-row mb-1"},qe=["placeholder","onUpdate:modelValue"],Re={class:"flex flex-col mt-5"},He={class:"flex flex-row mb-1"},ze=["placeholder","onUpdate:modelValue"],Qe={class:"w-1/2 pl-2 pr-2 flex flex-col justify-between min-h-[400px]"},We={class:"flex flex-col"},Xe={class:"colorSelect w-[150px]",id:"tagSelect2"},Ye=["label"],Ze=["value"],et={class:"flex flex-col"},tt={class:"flex flex-row justify-between"},lt=["onClick"],nt={class:"flex flex-row min-w-[500px]",key:"step3"},st={class:"px-2 w-1/2 [&>div]:my-2"},at={class:"flex flex-row"},ot={class:"flex flex-row"},it={class:"flex flex-row"},dt={class:"flex flex-row"},ut={class:"w-1/2"},rt={class:"flex flex-col"},ct={class:"my-2"},ft={class:"spread"},mt=["src"],pt={class:"min-w-[500px]",key:"step4"},vt={class:"w-5/6 mx-auto mt-5 flex flex-row flex-wrap justify-between mb-5 max-[450px]:justify-center"},xt={class:"w-2/5 min-w-[150px] max-[450px]:w-[100%]"},gt={class:"[&>span]:text-[20px] mb-3 text-center"},wt={key:0,class:"w-[100%] text-center text-amber-900 font-bold"},bt={key:1,class:"w-[100%] text-center text-slate-500 font-bold"},ht={key:2,class:"w-[100%] text-center text-yellow-600 font-bold"},yt={key:0,class:"imgbox1 max-w-[150px] mx-auto"},_t=["src","alt"],kt={key:1,class:"imgbox2 max-w-[150px] mx-auto"},$t=["src","alt"],Ct={key:2,class:"imgbox3 max-w-[150px] mx-auto"},Et=["src","alt"],It={class:"w-1/2 flex flex-col min-w-[150px] ml-2 max-[450px]:ml-0 max-[450px]:w-[100%]"},Bt={class:"flex flex-col mt-5 min-h-[10vh]"},St={class:"flex flex-row line"},Nt={key:0,class:"flex bg-amber-900 text-white rounded-md w-1/5 min-w-[100px] justify-center"},jt={key:1,class:"flex bg-slate-500 text-white rounded-md w-1/5 min-w-[100px] justify-center"},Dt={key:2,class:"flex bg-yellow-600 text-white rounded-md w-1/5 min-w-[100px] justify-center"},Pt={class:"flex flex-col"},Ft={class:"text-black"},Lt={class:"flex flex-col mt-5 min-h-[20vh]"},Tt={key:0,class:"flex bg-amber-900 text-white rounded-md w-1/5 min-w-[100px] justify-center"},Kt={key:1,class:"flex bg-slate-500 text-white rounded-md w-1/5 min-w-[100px] justify-center"},Ot={key:2,class:"flex bg-yellow-600 text-white rounded-md w-1/5 min-w-[100px] justify-center"},Jt={class:"flex flex-col"},Mt={class:"text-black"},Ut={class:"flex flex-col mt-5 min-h-[10vh]"},Vt={key:0,class:"flex bg-amber-900 text-white rounded-md w-1/5 min-w-[100px] justify-center"},At={key:1,class:"flex bg-slate-500 text-white rounded-md w-1/5 min-w-[100px] justify-center"},Gt={key:2,class:"flex bg-yellow-600 text-white rounded-md w-1/5 min-w-[100px] justify-center"},qt={class:"flex flex-col"},Rt={class:"text-black"},Ht={__name:"AddCard",props:["max","func"],emits:["close"],setup(K,{expose:j,emit:F}){let J=K,n=_({}),I=_([]),c=_(1),w=_(null),E=_(null),D=_(null),v=_([]),B=_([""]),$=_([""]),S=_([""]);const M=F;function H(){c.value=1,w.value=null,E.value=null,D.value=null,v.value=[],B.value=[""],$.value=[""],S.value=[""]}function U(f){document.getElementById(f).value=null,document.getElementById(f).click()}async function V(f){let l=document.getElementById(f).files[0];const i=new FileReader;i.onload=g=>{f==="iconInput"?w.value={file:g.target.result,name:l.name,realFile:l}:f==="imageInput"?E.value={file:g.target.result,name:l.name,realFile:l}:f==="spreadInput"&&(D.value={file:g.target.result,name:l.name,realFile:l})},await i.readAsDataURL(l)}function A(f){switch(f){case"combo":$.value.push("");break;case"round":B.value.push("");break;case"instant":S.value.push("");break}}function G(f){switch(f){case"combo":$.value.length>1&&($.value=$.value.filter((l,i)=>i!==$.value.length-1));break;case"round":B.value.length>1&&(B.value=B.value.filter((l,i)=>i!==B.value.length-1));break;case"instant":S.value.length>1&&(S.value=S.value.filter((l,i)=>i!==S.value.length-1));break}}function q(){var f=parseInt(document.getElementById("tagSelect2").value),l={};I.value.forEach(i=>{let g=i.data.find(C=>C.id===f);g!==void 0&&(l=g)}),!(v.value.includes(l)||f===0)&&(v.value.push(l),v.value=v.value.sort((i,g)=>i.id-g.id),n.value.tag===void 0&&(n.value.tag=[]),n.value.tag.push(f),n.value.tag=n.value.tag.sort((i,g)=>i-g))}function W(f){n.value.tag=n.value.tag.filter(l=>l!==f),v.value=v.value.filter(l=>l.id!==f),console.log(v)}function X(f){f.key==="Enter"&&(n.value.keyword===void 0&&(n.value.keyword=[]),n.value.keyword.push(f.target.value),f.target.value="",console.log(n.value.keyword))}function Y(){let f=event.data.value;if(Number(f)>0){let l={image:`/images/card/image/1_${n.value.id}.png`,index:f};n.value.spread=l}}async function P(){if(c.value<3){c.value+=1;return}if(c.value===3)if(n.value.PointMax===void 0||n.value.PointConsume===void 0||n.value.PointGet===void 0||n.value.PointEnter===void 0){alert("請輸入對應資料!!");return}else{L(),c.value+=1;return}if(c.value===4){console.log("step4"),c.value+=1;let f=new FormData;f.append("image",w.value.realFile),f.append("oldName",w.value.name.split(".")[0]),f.append("newName",`1_${n.value.id}`),console.log(f.getAll("image"));const l=await O.post("http://localhost:5000/card/icon",f,{headers:{"Content-Type":"multipart/form-data"}});console.log(l.data);let i=new FormData;if(i.append("image",E.value.realFile),i.append("oldName",E.value.name.split(".")[0]),i.append("newName",`1_${n.value.id}`),console.log(E.value),await O.post("http://localhost:5000/card/image",i,{headers:{"Content-Type":"multipart/form-data"}}),console.log(D),D.value!==null&&D.value!==void 0){console.log("開始上傳盤面");let C=new FormData;C.append("image",D.value.realFile),C.append("oldName",D.value.name.split(".")[0]),C.append("newName",`1_${n.value.id}`),await O.post("http://localhost:5000/card/spread",C,{headers:{"Content-Type":"multipart/form-data"}})}let g={series:1,card:n.value};await O.post("http://localhost:5000/card/add",g).then(C=>{console.log(C.data),alert("新卡片已添加"),M("close",""),M("updateCard",C.data),H()})}}function L(){n.value.id===void 0&&(n.value.id=J.max),n.value.roundEffect=B.value,n.value.instantEffect=S.value,n.value.comboEffect=$.value,n.value.image=`/images/card/icon/1_${n.value.id}.png`,n.value.fullimage=`/images/card/image/1_${n.value.id}.png`,document.getElementById("spreadIndex").value===null&&(n.value.spread={id:parseInt(document.getElementById("spreadIndex").value),image:`/images/card/image/${n.value.id}.png`});let f=[];v.value.forEach(i=>{f.push(parseInt(i.id))}),n.value.tag=f;let l={id:n.value.id,name:n.value.name,rarity:n.value.rarity,image:n.value.image,instantEffect:n.value.instantEffect,roundEffect:n.value.roundEffect,comboEffect:n.value.comboEffect,PointMax:parseInt(n.value.PointMax),PointEnter:parseInt(n.value.PointEnter),PointConsume:parseInt(n.value.PointConsume),PointGet:parseInt(n.value.PointGet),tag:n.value.tag,fullimage:n.value.fullimage,keyword:n.value.keyword,...n.value.spread?{spread:n.value.spread}:{}};n.value=l,console.log(n.value)}function T(f){I.value=f}return j({setFunc:T}),(f,l)=>(a(),o("div",Ee,[R(ve,{name:"step",tag:"div",class:"flex flex-row"},{default:ee(()=>[s(c)===1?(a(),o("div",Ie,[e("div",Be,[e("div",Se,[l[19]||(l[19]=e("span",{class:"text-lg"},"卡片名稱:",-1)),e("input",{type:"text",class:"selfInput",placeholder:"卡片名子",onChange:l[0]||(l[0]=i=>s(n).name=i.target.value)},null,32)]),e("div",Ne,[l[20]||(l[20]=e("span",{class:"text-lg mr-1"},"卡片編號:",-1)),e("span",null,x(K.max),1)]),e("div",je,[l[21]||(l[21]=e("span",{class:"text-lg"},"稀有度:",-1)),(a(),o(b,null,h(3,i=>e("div",null,[e("input",{type:"radio",name:"rarity",value:i,onChange:l[1]||(l[1]=g=>s(n).rarity=parseInt(g.target.value))},null,40,De),e("span",null,x(i+"星"),1)])),64))]),e("div",Pe,[l[22]||(l[22]=e("span",{class:"text-lg"},"縮圖:",-1)),e("button",{onClick:l[2]||(l[2]=i=>U("iconInput")),class:"max-w-[100px] addBtn"},"上傳"),e("input",{type:"file",id:"iconInput",class:"hidden",accept:"image/jpeg, image/png, image/jpg",onChange:l[3]||(l[3]=()=>V("iconInput"))},null,32),s(w)!==null?(a(),o("img",{key:0,src:s(w).file,alt:"縮圖",class:"max-w-[100px] max-h-[100px]"},null,8,Fe)):p("",!0)])]),e("div",Le,[e("div",Te,[l[23]||(l[23]=e("span",{class:"text-lg"},"全身圖:",-1)),e("button",{onClick:l[4]||(l[4]=i=>U("imageInput")),class:"max-w-[100px] addBtn"},"上傳"),e("input",{type:"file",id:"imageInput",class:"hidden",accept:"image/jpeg, image/png, image/jpg",onChange:l[5]||(l[5]=()=>V("imageInput"))},null,32),s(E)!==null?(a(),o("img",{key:0,src:s(E).file,alt:"縮圖",class:"max-w-[200px] max-h-[300px]"},null,8,Ke)):p("",!0)]),e("div",null,[e("button",{class:"addBtn pl-2 pr-2",onClick:P},"下一步")])])])):p("",!0),s(c)===2?(a(),o("div",Oe,[e("div",Je,[e("div",Me,[e("div",Ue,[l[24]||(l[24]=e("span",{class:"text-lg"},"即時效果:",-1)),e("button",{class:"addBtn ml-3 px-3",onClick:l[6]||(l[6]=i=>A("instant"))},"添加"),s(S).length>1?(a(),o("button",{key:0,class:"addBtn ml-3 px-3",onClick:l[7]||(l[7]=i=>G("instant"))},"刪除")):p("",!0)]),(a(!0),o(b,null,h(s(S),(i,g)=>Q((a(),o("input",{type:"text",class:"selfInput mt-1 mb-1",placeholder:"即使效果","onUpdate:modelValue":C=>s(S)[g]=C},null,8,Ve)),[[Z,s(S)[g]]])),256))]),e("div",Ae,[e("div",Ge,[l[25]||(l[25]=e("span",{class:"text-lg"},"回合效果:",-1)),e("button",{class:"addBtn ml-3 px-3",onClick:l[8]||(l[8]=i=>A("round"))},"添加"),s(B).length>1?(a(),o("button",{key:0,class:"addBtn ml-3 px-3",onClick:l[9]||(l[9]=i=>G("round"))},"刪除")):p("",!0)]),(a(!0),o(b,null,h(s(B),(i,g)=>Q((a(),o("input",{type:"text",class:"selfInput mt-1 mb-1 whitespace-pre-wrap",placeholder:`回合效果${g+1}`,"onUpdate:modelValue":C=>s(B)[g]=C},null,8,qe)),[[Z,s(B)[g]]])),256))]),e("div",Re,[e("div",He,[l[26]||(l[26]=e("span",{class:"text-lg"},"連動效果:",-1)),e("button",{class:"addBtn ml-3 px-3",onClick:l[10]||(l[10]=i=>A("combo"))},"添加"),s($).length>1?(a(),o("button",{key:0,class:"addBtn ml-3 px-3",onClick:l[11]||(l[11]=i=>G("combo"))},"刪除")):p("",!0)]),(a(!0),o(b,null,h(s($),(i,g)=>Q((a(),o("textarea",{class:"selfInput mt-1 mb-1 min-h-[25px] max-h-[50px]",placeholder:`連動效果${g+1}`,"onUpdate:modelValue":C=>s($)[g]=C},null,8,ze)),[[Z,s($)[g]]])),256))])]),e("div",Qe,[e("div",We,[l[28]||(l[28]=e("div",null,[e("span",null,"技能標籤")],-1)),e("div",null,[e("select",Xe,[l[27]||(l[27]=e("option",{value:0},x("請選擇"),-1)),(a(!0),o(b,null,h(s(I),i=>(a(),o("optgroup",{label:i.typeName},[(a(!0),o(b,null,h(i.data,g=>(a(),o("option",{value:g.id,class:"bg-amber-900"},x(g.name),9,Ze))),256))],8,Ye))),256))]),e("button",{class:"rounded-sm bg-gray-600 min-w-[50px] text-white",onClick:l[12]||(l[12]=i=>q())},"新增")]),e("div",et,[(a(!0),o(b,null,h(s(v),i=>(a(),o("div",tt,[e("span",null,x(i.id+" "+i.name),1),e("button",{class:"removeBtn",onClick:g=>W(i.id)},"移除",8,lt)]))),256))])]),e("div",null,[e("button",{class:"addBtn pl-2 pr-2",onClick:P},"下一步")])])])):p("",!0),s(c)===3?(a(),o("div",nt,[e("div",st,[e("div",at,[l[29]||(l[29]=e("div",{class:"w-[120px]"},[e("span",null,"回合累積能量:")],-1)),e("input",{type:"number",id:"pointGet",class:"inputNum",min:1,max:8,required:"",onChange:l[13]||(l[13]=i=>s(n).PointGet=i.target.value)},null,32)]),e("div",ot,[l[30]||(l[30]=e("div",{class:"w-[120px]"},[e("span",null,"總儲存能量:")],-1)),e("input",{type:"number",id:"pointMax",class:"inputNum",min:1,max:8,required:"",onChange:l[14]||(l[14]=i=>s(n).PointMax=i.target.value)},null,32)]),e("div",it,[l[31]||(l[31]=e("div",{class:"w-[120px]"},[e("span",null,"回合消耗能量:")],-1)),e("input",{type:"number",id:"pointConsume",class:"inputNum",min:1,max:8,required:"",onChange:l[15]||(l[15]=i=>s(n).PointConsume=i.target.value)},null,32)]),e("div",dt,[l[32]||(l[32]=e("div",{class:"w-[120px]"},[e("span",null,"進場能量:")],-1)),e("input",{type:"number",id:"pointEnter",class:"inputNum",min:1,max:8,required:"",onChange:l[16]||(l[16]=i=>s(n).PointEnter=i.target.value)},null,32)])]),e("div",ut,[e("div",rt,[l[33]||(l[33]=e("span",null,"卡片關鍵字:",-1)),e("input",{type:"text",class:"selfInput",placeholder:"輸入完成後按Enter",onKeydown:X},null,32),(a(!0),o(b,null,h(s(n).keyword,i=>(a(),o("span",null,x(i),1))),256))]),e("div",ct,[l[34]||(l[34]=e("span",null,"盤面圖:",-1)),e("button",{onClick:l[17]||(l[17]=i=>U("spreadInput")),class:"max-w-[100px] addBtn px-2"},"上傳"),e("input",{type:"file",id:"spreadInput",class:"hidden",accept:"image/jpeg, image/png, image/jpg",onChange:l[18]||(l[18]=()=>V("spreadInput"))},null,32),e("div",ft,[s(D)!==null?(a(),o("img",{key:0,src:s(D).file,alt:"盤面圖",class:"w-[240px]"},null,8,mt)):p("",!0)])]),e("div",{class:"my-2"},[l[35]||(l[35]=e("span",null,"圖片標示位置:",-1)),e("input",{type:"number",class:"selfInput",id:"spreadIndex",min:1,onClick:Y})]),e("div",{class:"mt-2"},[e("button",{class:"addBtn pl-2 pr-2",onClick:P},"下一步")])])])):p("",!0),s(c)===4||s(c)===5?(a(),o("div",pt,[e("div",vt,[e("div",xt,[e("div",gt,[s(n).rarity===1?(a(),o("span",wt,x(s(n).name),1)):p("",!0),s(n).rarity===2?(a(),o("span",bt,x(s(n).name),1)):p("",!0),s(n).rarity===3?(a(),o("span",ht,x(s(n).name),1)):p("",!0)]),s(n).rarity===1?(a(),o("div",yt,[e("img",{src:s(E).file,alt:s(n).name,class:"h-[40vh] min-w-[150px]"},null,8,_t)])):p("",!0),s(n).rarity===2?(a(),o("div",kt,[e("img",{src:s(E).file,alt:s(n).name,class:"h-[40vh] min-w-[150px]"},null,8,$t)])):p("",!0),s(n).rarity===3?(a(),o("div",Ct,[e("img",{src:s(E).file,alt:s(n).name,class:"h-[40vh] min-w-[150px]"},null,8,Et)])):p("",!0)]),e("div",It,[e("div",Bt,[e("div",St,[s(n).rarity===1?(a(),o("div",Nt,l[36]||(l[36]=[e("span",null,"即時效果",-1)]))):p("",!0),s(n).rarity===2?(a(),o("div",jt,l[37]||(l[37]=[e("span",null,"即時效果",-1)]))):p("",!0),s(n).rarity===3?(a(),o("div",Dt,l[38]||(l[38]=[e("span",null,"即時效果",-1)]))):p("",!0)]),e("div",Pt,[(a(!0),o(b,null,h(s(n).instantEffect,i=>(a(),o("span",Ft,"•"+x(i),1))),256))])]),e("div",Lt,[s(n).rarity===1?(a(),o("div",Tt,l[39]||(l[39]=[e("span",null,"回合效果",-1)]))):p("",!0),s(n).rarity===2?(a(),o("div",Kt,l[40]||(l[40]=[e("span",null,"回合效果",-1)]))):p("",!0),s(n).rarity===3?(a(),o("div",Ot,l[41]||(l[41]=[e("span",null,"回合效果",-1)]))):p("",!0),e("div",Jt,[(a(!0),o(b,null,h(s(n).roundEffect,i=>(a(),o("span",Mt,"•"+x(i),1))),256))])]),e("div",Ut,[s(n).rarity===1?(a(),o("div",Vt,l[42]||(l[42]=[e("span",null,"連動效果",-1)]))):p("",!0),s(n).rarity===2?(a(),o("div",At,l[43]||(l[43]=[e("span",null,"連動效果",-1)]))):p("",!0),s(n).rarity===3?(a(),o("div",Gt,l[44]||(l[44]=[e("span",null,"連動效果",-1)]))):p("",!0),e("div",qt,[(a(!0),o(b,null,h(s(n).comboEffect,i=>(a(),o("span",Rt,"•"+x(i),1))),256))])])])]),e("div",{class:"w-5/6 mt-5 mx-auto"},[e("button",{class:"addBtn min-w-[100px] ml-2",onClick:P},"儲存")])])):p("",!0)]),_:1})]))}},zt=ce(Ht,[["__scopeId","data-v-63d6fa32"]]),Qt={class:"main"},Wt={class:"w-4/5 mx-auto mb-2"},Xt={class:"flex flex-row"},Yt={class:"w-4/5 mx-auto flex flex-row justify-evenly"},Zt={key:0,class:"w-1/2 min-h-[500px] flex flex-row"},el={class:"CardImage w-1/2"},tl={class:"text-white font-bold text-xl"},ll=["src"],nl={class:"Details flex flex-col w-1/2 mt-5 [&>div]:mb-5"},sl={class:"flex flex-row"},al={class:"mb-3 flex flex-col"},ol=["onKeydown"],il={class:"flex flex-row"},dl={class:"mb-3 flex flex-col"},ul=["onKeydown"],rl={class:"flex flex-row"},cl={class:"mb-3 flex flex-col"},fl=["onKeydown"],ml={class:"flex flex-col"},pl=["onClick"],vl=["src"],xl={key:0,class:"text-red-500 text-md"},gl={key:1,class:"text-white text-md"},wl={key:1,class:"w-2/5 pl-3 right mt-5 h-[500px] relative"},bl={key:2,class:"w-2/5 pl-3 right mt-5 h-[500px] relative"},hl={class:"flex-col"},yl={class:"mb-3"},_l=["value"],kl={key:0},$l={class:"colorSelect w-[150px]",id:"tagSelect"},Cl=["label"],El=["value"],Il={key:1},Bl={class:"mb-2 flex-col"},Sl={class:"overflow-y-scroll hiddenScrollbar"},Nl={class:"flex flex-col"},jl={class:"flex flex-row my-1"},Dl={class:"w-1/5"},Pl={class:"text-white"},Fl={class:"w-2/5"},Ll={class:"text-white"},Tl={class:"w-2/5"},Kl=["id","onClick"],Ol={key:3,class:"w-2/5 pl-3 right mt-5 h-[500px] relative"},Jl={key:4,class:"w-2/5 pl-3 right mt-5 h-[500px] relative"},Ml={class:"my-5"},Ul={class:"flex flex-row"},Vl={class:"mb-3 flex flex-col"},Al=["onKeydown"],Gl={class:"my-5"},ql={class:"flex flex-row my-1"},Rl={class:"mb-3 flex flex-col"},Hl=["onKeydown"],zl={class:"my-5"},Ql={class:"flex flex-row my-1"},Wl={class:"mb-3 flex flex-col"},Xl=["onKeydown"],Yl={key:5,class:"w-2/5 pl-3 right mt-5 h-[500px] relative"},Zl={class:"w-3/5 mx-auto my-3"},en={class:"slide w-4/5 mx-auto mt-3 pt-3"},tn={class:"ml-5 mb-3"},ln={class:"flex flex-row"},nn=["onClick"],sn=["src"],an={key:0,class:"w-[100%] text-center bg-amber-900 text-white rounded-md"},on={key:1,class:"w-[100%] text-center bg-slate-500 text-white rounded-md"},dn={key:2,class:"w-[100%] text-center bg-yellow-600 text-white rounded-md"},un={class:"overlay",id:"overlay"},rn={class:"popup max-[500px]:w-[80%] max-[500px]:min-w-[200px]"};let pe=_(null);const cn={name:"App",components:{Carousel:me,Slide:fe,Pagination:Ce,Navigation:$e},methods:{slideItem:function(K,j){if(K.target.value>j||K.target.value<0)alert("該編號卡片資料沒有找到!!");else{let F=K.target.value;pe.value.data.slideTo(F-1)}}},data(){}},fn=Object.assign(cn,{setup(K){let j=[],F=[],J=_(1),n=_([]),I=_([]),c=_([]),w=_(1),E="",D=_(null),v=_({}),B=_([{name:"基本資訊",mode:"edit_basic"},{name:"效果敘述",mode:"edit_description"},{name:"技能標籤",mode:"edit_tag"},{name:"關鍵字",mode:"edit_keyword"},{name:"圖片管理",mode:"edit_img"},{name:"刪除卡片",mode:"delete"}]),$=_("edit_basic");const S=we("frontpath",""),M=_(S);function H(){O.post("http://localhost:5000/card/get",{get:J.value}).then(u=>{if(console.log(u.data),j=u.data.card,F=u.data.func,u.data=="發生錯誤"){console.log("沒有發現相關資料");return}I.value=JSON.parse(JSON.stringify(F)),c.value=JSON.parse(JSON.stringify(j)),q(1)}).catch(u=>{alert("伺服器尚未開啟請稍後再試!!"),window.location=window.location.origin+"/TestNuxtPage/"})}function U(u){let t=document.getElementById("series"+u);t.classList.contains("clicked")?t.classList.remove("clicked"):t.classList.add("clicked"),J.value=parseInt(u),H()}function V(u){n.value=n.value.filter((r,m)=>m!==u);let t=c.value.find(r=>r.id===parseInt(w.value)).tag;c.value.find(r=>r.id===parseInt(w.value)).tag=t.filter((r,m)=>m!==u),console.log(c.value.find(r=>r.id===parseInt(w.value)))}function A(){var u=parseInt(document.getElementById("tagSelect").value),t={};I.value.forEach(r=>{let m=r.data.find(y=>y.id===u);m!==void 0&&(t=m)}),!(n.value.includes(t)||u===0)&&(n.value.push(t),n.value=n.value.sort((r,m)=>r.id-m.id),c.value.find(r=>r.id===w.value).tag.push(u),c.value.find(r=>r.id===w.value).tag=c.value.find(r=>r.id===w.value).tag.sort((r,m)=>r-m),console.log(j.find(r=>r.id===w.value).tag),console.log(c.value.find(r=>r.id===w.value).tag))}function G(){if(confirm("將會儲存你所做的所有更改，如果確定覆蓋則按確定"))try{let u={getId:J.value,newData:c.value};console.log(u),O.post("http://localhost:5000/card/edit",u).then(t=>{console.log(t),alert(t.data),j=JSON.parse(JSON.stringify(c.value))})}catch(u){console.log(u)}}function q(u){w.value=u,v.value=c.value.find(t=>t.id===w.value),n.value=[],v.value.tag.forEach(t=>{F.forEach(r=>{let m=r.data.find(y=>y.id===t);m!==void 0&&n.value.push(m)})})}function W(){let u={series:J.value,id:w.value};O.post("http://localhost:5000/card/delete",u).then(t=>{console.log(t),c.value=c.value.filter(r=>r.id!==w.value),console.log(c.value),j=JSON.parse(JSON.stringify(c.value)),q(c.value[0].id),alert("卡片刪除成功!")})}function X(u){if(E=u.target.value,console.log(E),E===""){I.value=F;return}let t=[];F.forEach(r=>{let m=[];if(r.data.forEach(y=>{y.name.includes(E)&&m.push(y)}),m.length!==0){console.log(m);let y=r;y.data=m,t.push(y)}}),t.length!==0?I.value=t:I.value=[]}function Y(){let u=j.find(r=>r.id===w.value);if(u==null)return;let t=JSON.parse(JSON.stringify(u));n.value=[],t.tag.forEach(r=>{F.forEach(m=>{let y=m.data.find(z=>z.id===r);y!==void 0&&n.value.push(y)})}),v.value=t,Object.assign(u,t)}function P(u){u.target.parentElement.querySelector("textarea").classList.remove("hidden"),u.target.classList.add("hidden")}function L(u,t,r=void 0){if(console.log(u.key),u.key==="Enter"){switch(t){case"instant":c.value[w.value-1].instantEffect[r]=u.target.value;break;case"round":c.value[w.value-1].roundEffect[r]=u.target.value;break;case"combo":c.value[w.value-1].comboEffect[r]=u.target.value;break}console.log(c.value.find(y=>y.id===w.value)),u.target.parentElement.querySelector("span").classList.remove("hidden"),u.target.classList.add("hidden");return}if(u.key,u.key==="Delete")switch(t){case"instant":break;case"round":c.value.find(m=>m.id===w.value).roundEffect=c.value.find(m=>m.id===w.value).roundEffect.filter((m,y)=>y!==r);break;case"combo":c.value.find(m=>m.id===w.value).comboEffect=c.value.find(m=>m.id===w.value).comboEffect.filter((m,y)=>y!==r);break}}function T(u){let t=c.value.find(r=>r.id===w.value);switch(u){case"round":t.roundEffect.push("回合效果");break;case"instant":t.instantEffect.push("即時效果");break;case"combo":t.comboEffect.push("連動效果");break}}function f(u){let t=c.value.find(r=>r.id===w.value);switch(u){case"round":if(t.roundEffect.length===1)break;t.roundEffect=t.roundEffect.filter((r,m)=>m!==t.roundEffect.length-1);break;case"instant":if(t.instantEffect.length===1)break;t.instantEffect=t.instantEffect.filter((r,m)=>m!==t.instantEffect.length-1);break;case"combo":if(t.comboEffect.length===1)break;t.comboEffect=t.comboEffect.filter((r,m)=>m!==t.comboEffect.length-1);break}}function l(){document.getElementById("overlay").style.display="block",D.value.setFunc(I.value)}function i(){document.getElementById("overlay").style.display="none"}function g(u){$.value=u}function C(u){j=u,c.value=JSON.parse(JSON.stringify(j))}return xe(v,(u,t)=>{c.value[u.id-1]=u},{deep:!0}),he("close",i),ge(()=>{H()}),(u,t)=>{var r,m,y,z,te,le,ne,se,ae,oe,ie,de,ue;return a(),o("div",Qt,[e("div",Wt,[t[22]||(t[22]=e("span",{class:"text-white text-xl"},"系列",-1)),e("div",Xt,[e("button",{class:"addBtn mr-5 w-[100px]",onClick:t[0]||(t[0]=d=>U(1)),id:"series1"},"晨曦塔"),e("button",{class:"addBtn mr-5 w-[100px]",onClick:t[1]||(t[1]=d=>U(2)),id:"series2"},"測試塔")])]),e("div",Yt,[s(v)!==void 0?(a(),o("div",Zt,[e("div",el,[e("span",tl,x(s(v).name),1),e("img",{src:M.value+s(v).fullimage,alt:"全身圖",class:"max-h-[500px]"},null,8,ll)]),Q(e("div",nl,[e("div",null,[e("div",sl,[t[23]||(t[23]=e("span",{class:"standwardLabel"},"即時效果",-1)),e("button",{class:"addBtn ml-5",onClick:t[2]||(t[2]=d=>T("instant"))},"新增"),((m=(r=s(v))==null?void 0:r.instantEffect)==null?void 0:m.length)>1?(a(),o("button",{key:0,class:"addBtn ml-5",onClick:t[3]||(t[3]=d=>f("instant"))},"刪除")):p("",!0)]),(a(!0),o(b,null,h(s(v).instantEffect,(d,k)=>(a(),o("div",al,[e("span",{class:"text-white font-bold",onDblclick:P},x(d),33),e("textarea",{class:"hidden bg-gray-600 text-white h-auto rounded-sm min-h-[50px]",onKeydown:N=>L(N,"instant",k)},x(d),41,ol)]))),256))]),e("div",null,[e("div",il,[t[24]||(t[24]=e("span",{class:"standwardLabel"},"回合效果",-1)),e("button",{class:"addBtn ml-5",onClick:t[4]||(t[4]=d=>T("round"))},"新增"),((z=(y=s(v))==null?void 0:y.roundEffect)==null?void 0:z.length)>1?(a(),o("button",{key:0,class:"addBtn ml-5",onClick:t[5]||(t[5]=d=>f("round"))},"刪除")):p("",!0)]),(a(!0),o(b,null,h(s(v).roundEffect,(d,k)=>(a(),o("div",dl,[e("span",{class:"text-white font-bold",onDblclick:P},x(d),33),e("textarea",{class:"hidden bg-gray-600 text-white h-auto rounded-sm min-h-[50px]",onKeydown:N=>L(N,"round",k)},x(d),41,ul)]))),256))]),e("div",null,[e("div",rl,[t[25]||(t[25]=e("span",{class:"standwardLabel"},"連動效果",-1)),e("button",{class:"addBtn ml-5",onClick:t[6]||(t[6]=d=>T("combo"))},"新增"),((le=(te=s(v))==null?void 0:te.comboEffect)==null?void 0:le.length)>1?(a(),o("button",{key:0,class:"addBtn ml-5",onClick:t[7]||(t[7]=d=>f("combo"))},"刪除")):p("",!0)]),(a(!0),o(b,null,h(s(v).comboEffect,(d,k)=>(a(),o("div",cl,[e("span",{class:"text-white font-bold",onDblclick:P},x(d),33),e("textarea",{class:"hidden bg-gray-600 text-white h-auto rounded-sm min-h-[50px]",onKeydown:N=>L(N,"combo",k)},x(d),41,fl)]))),256))])],512),[[ye,!1]]),e("div",null,[t[26]||(t[26]=e("span",{class:"text-red-700 text-lg"},"選擇要編輯的項目:",-1)),e("div",ml,[(a(!0),o(b,null,h(s(B),d=>(a(),o("div",{class:"my-2 flex flex-row cursor-pointer",onClick:k=>g(d.mode)},[e("img",{src:M.value+"/images/arrow_right.png",width:"20",height:"20"},null,8,vl),d.mode==="delete"?(a(),o("span",xl,x(d.name),1)):(a(),o("span",gl,x(d.name),1))],8,pl))),256))])])])):p("",!0),s($)=="edit_basic"?(a(),o("div",wl,[R(_e,{card:s(v),"onUpdate:card":t[8]||(t[8]=d=>re(v)?v.value=d:v=d)},null,8,["card"])])):p("",!0),s($)=="edit_tag"?(a(),o("div",bl,[e("div",hl,[t[29]||(t[29]=e("span",{class:"standwardLabel"},"自身技能標籤",-1)),e("div",yl,[e("input",{type:"text",value:s(E),placeholder:"技能關鍵字",onInput:t[9]||(t[9]=d=>X(d)),class:"colorSelect"},null,40,_l)]),((ne=s(I))==null?void 0:ne.length)!==0?(a(),o("div",kl,[e("select",$l,[t[27]||(t[27]=e("option",{value:0},x("請選擇"),-1)),(a(!0),o(b,null,h(s(I),d=>(a(),o("optgroup",{label:d.typeName},[(a(!0),o(b,null,h(d.data,k=>(a(),o("option",{value:k.id,class:"bg-amber-900"},x(k.name),9,El))),256))],8,Cl))),256))]),e("button",{class:"rounded-sm bg-gray-600 min-w-[50px] text-white",onClick:t[10]||(t[10]=d=>A())},"新增")])):(a(),o("div",Il,t[28]||(t[28]=[e("span",{class:"text-yellow-500 font-bold text-lg"},"沒有找到匹配技能標籤",-1)])))]),e("div",Bl,[e("div",Sl,[e("div",Nl,[(a(!0),o(b,null,h(s(n),(d,k)=>(a(),o("div",jl,[e("div",Dl,[e("span",Pl,x(d.id),1)]),e("div",Fl,[e("span",Ll,x(d.name),1)]),e("div",Tl,[e("button",{class:"removeBtn",id:"btns"+k,onClick:N=>V(k)},"移除",8,Kl)])]))),256))])])])])):p("",!0),s($)=="edit_keyword"?(a(),o("div",Ol,[R(ke,{card:s(v),"onUpdate:card":t[11]||(t[11]=d=>re(v)?v.value=d:v=d)},null,8,["card"])])):p("",!0),s($)=="edit_description"?(a(),o("div",Jl,[t[33]||(t[33]=e("div",null,[e("span",{class:"text-amber-800 text-[18px]"},"效果敘述")],-1)),e("div",Ml,[e("div",Ul,[t[30]||(t[30]=e("span",{class:"standwardSubLabel"},"即時效果",-1)),e("button",{class:"addBtn ml-5",onClick:t[12]||(t[12]=d=>T("instant"))},"新增"),((ae=(se=s(v))==null?void 0:se.instantEffect)==null?void 0:ae.length)>1?(a(),o("button",{key:0,class:"addBtn ml-5",onClick:t[13]||(t[13]=d=>f("instant"))},"刪除")):p("",!0)]),(a(!0),o(b,null,h(s(v).instantEffect,(d,k)=>(a(),o("div",Vl,[e("span",{class:"text-white font-bold",onDblclick:P},x(d),33),e("textarea",{class:"hidden bg-gray-600 text-white h-auto rounded-sm min-h-[50px]",onKeydown:N=>L(N,"instant",k)},x(d),41,Al)]))),256))]),e("div",Gl,[e("div",ql,[t[31]||(t[31]=e("span",{class:"standwardSubLabel"},"回合效果",-1)),e("button",{class:"addBtn ml-5",onClick:t[14]||(t[14]=d=>T("round"))},"新增"),((ie=(oe=s(v))==null?void 0:oe.roundEffect)==null?void 0:ie.length)>1?(a(),o("button",{key:0,class:"addBtn ml-5",onClick:t[15]||(t[15]=d=>f("round"))},"刪除")):p("",!0)]),(a(!0),o(b,null,h(s(v).roundEffect,(d,k)=>(a(),o("div",Rl,[e("span",{class:"text-white font-bold",onDblclick:P},x(d),33),e("textarea",{class:"hidden bg-gray-600 text-white h-auto rounded-sm min-h-[50px]",onKeydown:N=>L(N,"round",k)},x(d),41,Hl)]))),256))]),e("div",zl,[e("div",Ql,[t[32]||(t[32]=e("span",{class:"standwardSubLabel"},"連動效果",-1)),e("button",{class:"addBtn ml-5",onClick:t[16]||(t[16]=d=>T("combo"))},"新增"),((ue=(de=s(v))==null?void 0:de.comboEffect)==null?void 0:ue.length)>1?(a(),o("button",{key:0,class:"addBtn ml-5",onClick:t[17]||(t[17]=d=>f("combo"))},"刪除")):p("",!0)]),(a(!0),o(b,null,h(s(v).comboEffect,(d,k)=>(a(),o("div",Wl,[e("span",{class:"text-white font-bold",onDblclick:P},x(d),33),e("textarea",{class:"hidden bg-gray-600 text-white h-auto rounded-sm min-h-[50px]",onKeydown:N=>L(N,"combo",k)},x(d),41,Xl)]))),256))])])):p("",!0),s($)=="delete"?(a(),o("div",Yl,[t[35]||(t[35]=e("div",null,[e("span",{class:"text-amber-800 text-[18px]"},"刪除卡片")],-1)),e("div",{class:"flex flex-col mt-2 justify-start"},[t[34]||(t[34]=e("span",{class:"text-white"},"經過此操作後，該筆資料將永久刪除，按下下面按鈕以確認操作",-1)),e("button",{class:"removeBtn w-[100px]",onClick:W},"確認刪除")])])):p("",!0)]),e("div",Zl,[e("button",{class:"removeBtn min-w-[150px] mb-3",onClick:t[18]||(t[18]=d=>G())},"儲存"),e("button",{class:"removeBtn min-w-[150px] mb-3",onClick:t[19]||(t[19]=d=>Y())},"還原")]),e("div",en,[e("div",tn,[t[36]||(t[36]=e("span",{class:"text-white"},"請輸入要卡片編號:",-1)),e("div",ln,[e("input",{type:"number",class:"w-[100px] rounded-md text-center",onChange:t[20]||(t[20]=d=>u.slideItem(d,s(c).length))},null,32),e("button",{class:"addBtn ml-3 px-3",onClick:t[21]||(t[21]=()=>l())},"添加卡片")])]),R(s(me),{"wrap-around":!0,"items-to-show":5,ref_key:"cardSlide",ref:pe},{default:ee(()=>[(a(!0),o(b,null,h(s(c),(d,k)=>(a(),be(s(fe),{key:k},{default:ee(()=>[e("div",{class:"flex-col [&>span]:block cursor-pointer",onClick:N=>q(d.id)},[e("img",{src:M.value+d.image,width:"160",alt:"not found"},null,8,sn),d.rarity===1?(a(),o("span",an,x(d.id),1)):p("",!0),d.rarity===2?(a(),o("span",on,x(d.id),1)):p("",!0),d.rarity===3?(a(),o("span",dn,x(d.id),1)):p("",!0)],8,nn)]),_:2},1024))),128))]),_:1},512)]),e("div",un,[e("div",rn,[e("div",{class:"close",onClick:i},"✖"),R(zt,{ref_key:"popup",ref:D,max:s(c).length+1,func:s(I),onClose:i,onUpdateCard:C},null,8,["max","func"])])])])}}}),wn=ce(fn,[["__scopeId","data-v-ab2b3857"]]);export{wn as default};
