import{_ as ee,r as i,c as v,a as e,b as te,w as O,T as F,f as D,u as r,t as b,F as w,p as C,o as u,H as le}from"./HbLy4QWt.js";import{a as $}from"./Dq7h7Pqt.js";const ne={class:"main"},ae={class:"mx-auto w-4/5"},de={class:"flex flex-row"},oe={class:"max-h-[450px] overflow-y-scroll w-1/3",id:"skill"},se={class:"flex flex-row sticky top-2 bg-black"},ie={class:"text-amber-800 text-lg font-bold pl-3"},ue=["onClick"],ce=["onClick"],ve={class:"flex flex-col"},re={class:"text-white h-[30px] flex items-center"},me=["onClick"],pe=["onClick"],fe={class:"w-2/3 pl-5"},ye={key:0},xe={class:"flex flex-col"},ge={class:"flex flex-row mb-2 mt-2"},he=["max"],Ie={key:1},_e={class:"mt-5 mb-5"},be=["value"],Be={class:"mt-5 mb-5"},ke=["value","selected"],we={class:"mt-5 mb-5"},Ce={class:"flex flex-row"},Ee=["value","max"],Se={__name:"ModifyFunc",setup(Pe){let n=i([]),c=i(""),f=[],m=i(0),B=i(0),g=i(null),y=i(null),k=i(null),h=i(1),x=i(1),p=i([]);$.post("http://localhost:5000/func/get").then(l=>{f=l.data.func,n.value=JSON.parse(JSON.stringify(f)),E()});function E(){f.forEach(l=>{x.value+=1,l.data.forEach(t=>{h.value+=1})}),console.log(h.value)}function L(l){if(l.key=="Enter"){let t={typeId:x.value,typeName:l.target.value,data:[]};n.value.push(t),console.log(n.value);let a={method:"addSeries",data:{typeId:x.value,typeName:l.target.value}};p.value.push(a),I(),x.value+=1;let d=document.getElementById("skill");d.scrollTo(0,d.scrollHeight)}}function V(){n.value=JSON.parse(JSON.stringify(f)),p.value=[],E()}function H(l){m.value=l,c.value="add",y.value=n.value.find(t=>t.typeId==m.value).data.length+1}function A(){let l=document.getElementById("input1").value,t=document.getElementById("addPos").value,a={id:h.value,name:l};console.log(n.value.find(d=>d.typeId===m.value)),n.value.find(d=>d.typeId===m.value).data.splice(t-1,0,a),alert("技能標籤已加入"),I(),h.value+=1}function G(l,t){c.value="edit",m.value=l,B.value=t;let a=n.value.find(o=>o.typeId===l).data.find(o=>o.id===t),d=n.value.find(o=>o.typeId===l).data.findIndex(o=>o.id===t);y.value=n.value.find(o=>o.typeId===l).data.length+1,k.value=a,g.value=d}function K(l,t){let a=n.value.find(o=>o.typeId===l);a.data=a.data.filter(o=>o.id!==t);let d={method:"deleteTag",data:{type:l,id:t}};p.value.push(d),console.log(p)}function R(){let l={id:B.value,name:document.getElementById("editname").value};function t(o,W,T,X,Y){let Z=n.value.find(s=>s.typeId===o).data.find((s,J)=>J===W),M=n.value.find(s=>s.typeId==T).data;Z.delete=!0,M.splice(X,0,Y),n.value.find(s=>s.typeId==T).data=M,console.log(n.value);let _=n.value.find(s=>s.typeId===o).data;_=_.filter((s,J)=>s.delete!==!0),console.log(_),n.value.find(s=>s.typeId===o).data=_}let a=m.value,d=document.getElementById("beyond").value;t(a,g.value,d,document.getElementById("editPos").value-1,l),console.log(n.value),alert("修改位置完畢!!"),I()}function S(){alert("取消操作"),I()}function j(l){if(confirm(`確定刪除這個系列嗎?如果誤刪可以透過還原恢復
但如果送出儲存成功則無法恢復
確定刪除嗎?`)){n.value=n.value.filter(d=>d.typeId!==l),alert("刪除成功!!"),x.value-=1;let a={method:"deleteSeries",data:{typeId:l}};p.value.push(a)}console.log(n.value)}function q(){let l=parseInt(document.getElementById("beyond").value);document.getElementById("editPos").max=n.value.find(t=>t.typeId===l).data.length+1,document.getElementById("editPos").value=1}function P(){if(c.value==="edit")document.getElementById("editPos").value=parseInt(document.getElementById("editPos").min);else if(c.value==="add")document.getElementById("addPos").value=parseInt(document.getElementById("addPos").min);else return}function N(){if(c.value==="edit")document.getElementById("editPos").value=parseInt(document.getElementById("editPos").max);else if(c.value==="add")document.getElementById("addPos").value=parseInt(document.getElementById("addPos").max);else return}function z(l){l.target.classList.remove("hideBtn")}function Q(l){l.target.classList.add("hideBtn")}function I(){m.value=0,B.value=0,g.value=null,y.value=null,k.value=null,c.value=""}function U(){let l={func:n.value,moves:p.value};console.log(l),$.post("http://localhost:5000/func/save",l).then(async t=>{alert(t.data.msg),f=JSON.parse(JSON.stringify(n.value)),console.log(t.data),p.value=[]}).catch(t=>{alert("伺服器尚未開啟請稍後再試!!"),window.location=window.location.origin+"/TestNuxtPage/"})}return(l,t)=>(u(),v("div",ne,[e("div",ae,[t[9]||(t[9]=e("div",null,[e("span",{class:"text-red-500 text-2xl font-bold"},"技能管理")],-1)),e("div",null,[e("input",{type:"text",class:"rounded bg-gray-600 text-white",placeholder:"技能系列名稱",onKeydown:L},null,32),e("button",{class:"addBtn",onClick:V},"還原"),e("button",{class:"addBtn",onClick:U},"送出")]),e("div",de,[e("div",oe,[te(F,{tag:"div",name:"type"},{default:O(()=>[(u(!0),v(w,null,C(r(n),a=>(u(),v("div",{class:"mt-5 mb-5",key:"type"+a.id},[e("div",se,[e("span",ie,b(a.typeName),1),e("button",{class:"addBtn",onClick:d=>H(a.typeId)},"添加技能",8,ue),e("button",{class:"addBtn",onClick:d=>j(a.typeId)},"刪除",8,ce)]),e("div",ve,[(u(),le(F,{tag:"div",name:"list",key:a},{default:O(()=>[(u(!0),v(w,null,C(a.data,d=>(u(),v("div",{class:"flex flex-row hideBtn mt-1 mb-1",key:d,onMouseenter:z,onMouseleave:Q},[e("span",re,b(d.id+" "+d.name),1),e("button",{class:"addBtn",onClick:o=>G(a.typeId,d.id)},"修改",8,me),e("button",{class:"removeBtn",onClick:o=>K(a.typeId,d.id)},"刪除",8,pe)],32))),128))]),_:2},1024))])]))),128))]),_:1})]),e("div",fe,[r(c)==="add"?(u(),v("div",ye,[e("div",null,[t[2]||(t[2]=e("div",null,[e("span",{class:"text-red-500 font-bold text-lg"},"新增技能")],-1)),e("div",xe,[t[1]||(t[1]=e("div",{class:"flex flex-row mt-2 mb-2"},[e("span",{class:"text-white"},"技能簡短敘述:"),e("input",{type:"text",placeholder:"技能敘述",class:"rounded bg-gray-600 text-white",id:"input1"})],-1)),e("div",ge,[t[0]||(t[0]=e("span",{class:"text-white"},"技能插入位置:",-1)),e("input",{type:"number",placeholder:"變動位置",class:"rounded bg-gray-600 text-white",id:"addPos",min:1,max:r(y)},null,8,he),e("button",{class:"addBtn index",onClick:P},"最前面"),e("button",{class:"addBtn index",onClick:N},"最後面")]),e("div",null,[e("button",{class:"addBtn",onClick:A},"新增"),e("button",{class:"addBtn",onClick:S},"取消")])]),t[3]||(t[3]=e("div",null,[e("span",{class:"text-red-300"},b("*技能將會添加至指定系列位置"))],-1))])])):D("",!0),r(c)==="edit"?(u(),v("div",Ie,[t[8]||(t[8]=e("div",null,[e("span",{class:"text-red-500 font-bold text-lg"},"修改技能標籤設定")],-1)),e("div",_e,[t[4]||(t[4]=e("span",{class:"text-white font-bold"},"修改技能名稱",-1)),t[5]||(t[5]=e("br",null,null,-1)),e("input",{type:"text",value:r(k).name,placeholder:"技能描述",class:"rounded bg-gray-600 text-white",id:"editname"},null,8,be)]),e("div",Be,[t[6]||(t[6]=e("span",{class:"text-white font-bold"},"歸屬於",-1)),e("div",null,[e("select",{class:"colorSelect",id:"beyond",onChange:q},[(u(!0),v(w,null,C(r(n),a=>(u(),v("option",{value:a.typeId,selected:a.typeId===r(m)},b(a.typeName),9,ke))),256))],32)])]),e("div",we,[t[7]||(t[7]=e("span",{class:"text-white font-bold"},"擺放位置",-1)),e("div",Ce,[e("input",{type:"number",value:r(g)+1,min:1,max:r(y),id:"editPos"},null,8,Ee),e("button",{class:"addBtn index",onClick:P},"最前面"),e("button",{class:"addBtn index",onClick:N},"最後面")])]),e("div",{class:"flex flex-row mt-10"},[e("button",{class:"addBtn",onClick:R},"儲存變更"),e("button",{class:"addBtn",onClick:S},"取消操作")])])):D("",!0)])])])]))}},Me=ee(Se,[["__scopeId","data-v-2be7ecdd"]]);export{Me as default};
