import{_ as ce,r as _,c as o,o as a,b as R,w as ee,f as p,u as s,a as e,t as x,F as b,p as y,g as z,H as Z,T as xe,m as ge,l as we,y as be,j as re,i as ye,I as he,s as _e,v as ke}from"./lVwsCh73.js";import{a as K}from"./Dq7h7Pqt.js";import $e from"./DA3zB1Hy.js";import Ce from"./C-lVNcvN.js";import{N as Ee,P as Ie,S as fe,C as me}from"./CkVtHnU1.js";const Be={class:"h-[450px] pl-5"},Se={class:"flex flex-row min-w-[500px]",key:"step1"},Ne={class:"pl-2 pr-2 w-1/2"},je={class:"flex flex-col"},De={class:"mt-3 flex flex-row items-baseline"},Pe={class:"flex flex-col mt-5"},Fe=["value"],Le={class:"flex flex-col mt-5"},Te=["src"],Ke={class:"pl-2 pr-2 w-1/2 flex flex-col justify-between"},Oe={class:"flex flex-col"},Je=["src"],Me={key:"step2",class:"flex flex-row min-w-[500px]"},Ue={class:"w-1/2 pl-2 pr-2 flex flex-col"},Ve={class:"flex flex-col"},Ae={class:"flex flex-row mb-1"},qe=["onUpdate:modelValue"],Ge={class:"flex flex-col mt-5"},Re={class:"flex flex-row mb-1"},He=["placeholder","onUpdate:modelValue"],ze={class:"flex flex-col mt-5"},Qe={class:"flex flex-row mb-1"},We=["placeholder","onUpdate:modelValue"],Xe={class:"w-1/2 pl-2 pr-2 flex flex-col justify-between min-h-[400px]"},Ye={class:"flex flex-col"},Ze={class:"colorSelect w-[150px]",id:"tagSelect2"},et=["label"],tt=["value"],lt={class:"flex flex-col"},nt={class:"flex flex-row justify-between"},st=["onClick"],at={class:"flex flex-row min-w-[500px]",key:"step3"},ot={class:"px-2 w-1/2 [&>div]:my-2"},it={class:"flex flex-row"},dt={class:"flex flex-row"},ut={class:"flex flex-row"},rt={class:"flex flex-row"},ct={class:"w-1/2"},ft={class:"flex flex-col"},mt={class:"my-2"},pt={class:"spread"},vt=["src"],xt={class:"min-w-[500px]",key:"step4"},gt={class:"w-5/6 mx-auto mt-5 flex flex-row flex-wrap justify-between mb-5 max-[450px]:justify-center"},wt={class:"w-2/5 min-w-[150px] max-[450px]:w-[100%]"},bt={class:"[&>span]:text-[20px] mb-3 text-center"},yt={key:0,class:"w-[100%] text-center text-amber-900 font-bold"},ht={key:1,class:"w-[100%] text-center text-slate-500 font-bold"},_t={key:2,class:"w-[100%] text-center text-yellow-600 font-bold"},kt={key:0,class:"imgbox1 max-w-[150px] mx-auto"},$t=["src","alt"],Ct={key:1,class:"imgbox2 max-w-[150px] mx-auto"},Et=["src","alt"],It={key:2,class:"imgbox3 max-w-[150px] mx-auto"},Bt=["src","alt"],St={class:"w-1/2 flex flex-col min-w-[150px] ml-2 max-[450px]:ml-0 max-[450px]:w-[100%]"},Nt={class:"flex flex-col mt-5 min-h-[10vh]"},jt={class:"flex flex-row line"},Dt={key:0,class:"flex bg-amber-900 text-white rounded-md w-1/5 min-w-[100px] justify-center"},Pt={key:1,class:"flex bg-slate-500 text-white rounded-md w-1/5 min-w-[100px] justify-center"},Ft={key:2,class:"flex bg-yellow-600 text-white rounded-md w-1/5 min-w-[100px] justify-center"},Lt={class:"flex flex-col"},Tt={class:"text-black"},Kt={class:"flex flex-col mt-5 min-h-[20vh]"},Ot={key:0,class:"flex bg-amber-900 text-white rounded-md w-1/5 min-w-[100px] justify-center"},Jt={key:1,class:"flex bg-slate-500 text-white rounded-md w-1/5 min-w-[100px] justify-center"},Mt={key:2,class:"flex bg-yellow-600 text-white rounded-md w-1/5 min-w-[100px] justify-center"},Ut={class:"flex flex-col"},Vt={class:"text-black"},At={class:"flex flex-col mt-5 min-h-[10vh]"},qt={key:0,class:"flex bg-amber-900 text-white rounded-md w-1/5 min-w-[100px] justify-center"},Gt={key:1,class:"flex bg-slate-500 text-white rounded-md w-1/5 min-w-[100px] justify-center"},Rt={key:2,class:"flex bg-yellow-600 text-white rounded-md w-1/5 min-w-[100px] justify-center"},Ht={class:"flex flex-col"},zt={class:"text-black"},Qt={__name:"AddCard",props:["max","func"],emits:["close"],setup(T,{expose:j,emit:P}){let O=T,n=_({}),I=_([]),c=_(1),w=_(null),E=_(null),D=_(null),v=_([]),B=_([""]),$=_([""]),S=_([""]);const J=P;function Q(){c.value=1,w.value=null,E.value=null,D.value=null,v.value=[],B.value=[""],$.value=[""],S.value=[""]}function M(f){document.getElementById(f).value=null,document.getElementById(f).click()}async function U(f){let l=document.getElementById(f).files[0];const i=new FileReader;i.onload=g=>{f==="iconInput"?w.value={file:g.target.result,name:l.name,realFile:l}:f==="imageInput"?E.value={file:g.target.result,name:l.name,realFile:l}:f==="spreadInput"&&(D.value={file:g.target.result,name:l.name,realFile:l})},await i.readAsDataURL(l)}function A(f){switch(f){case"combo":$.value.push("");break;case"round":B.value.push("");break;case"instant":S.value.push("");break}}function q(f){switch(f){case"combo":$.value.length>1&&($.value=$.value.filter((l,i)=>i!==$.value.length-1));break;case"round":B.value.length>1&&(B.value=B.value.filter((l,i)=>i!==B.value.length-1));break;case"instant":S.value.length>1&&(S.value=S.value.filter((l,i)=>i!==S.value.length-1));break}}function W(){var f=parseInt(document.getElementById("tagSelect2").value),l={};I.value.forEach(i=>{let g=i.data.find(C=>C.id===f);g!==void 0&&(l=g)}),!(v.value.includes(l)||f===0)&&(v.value.push(l),v.value=v.value.sort((i,g)=>i.id-g.id),n.value.tag===void 0&&(n.value.tag=[]),n.value.tag.push(f),n.value.tag=n.value.tag.sort((i,g)=>i-g))}function G(f){n.value.tag=n.value.tag.filter(l=>l!==f),v.value=v.value.filter(l=>l.id!==f),console.log(v)}function X(f){f.key==="Enter"&&(n.value.keyword===void 0&&(n.value.keyword=[]),n.value.keyword.push(f.target.value),f.target.value="",console.log(n.value.keyword))}function Y(){let f=event.data.value;if(Number(f)>0){let l={image:`/images/card/image/1_${n.value.id}.png`,index:f};n.value.spread=l}}async function V(){if(c.value<3){c.value+=1;return}if(c.value===3)if(n.value.PointMax===void 0||n.value.PointConsume===void 0||n.value.PointGet===void 0||n.value.PointEnter===void 0){alert("請輸入對應資料!!");return}else{F(),c.value+=1;return}if(c.value===4){console.log("step4"),c.value+=1;let f=new FormData;f.append("image",w.value.realFile),f.append("oldName",w.value.name.split(".")[0]),f.append("newName",`1_${n.value.id}`),console.log(f.getAll("image"));const l=await K.post("http://localhost:5000/card/icon",f,{headers:{"Content-Type":"multipart/form-data"}});console.log(l.data);let i=new FormData;if(i.append("image",E.value.realFile),i.append("oldName",E.value.name.split(".")[0]),i.append("newName",`1_${n.value.id}`),console.log(E.value),await K.post("http://localhost:5000/card/image",i,{headers:{"Content-Type":"multipart/form-data"}}),console.log(D),D.value!==null&&D.value!==void 0){console.log("開始上傳盤面");let C=new FormData;C.append("image",D.value.realFile),C.append("oldName",D.value.name.split(".")[0]),C.append("newName",`1_${n.value.id}`),await K.post("http://localhost:5000/card/spread",C,{headers:{"Content-Type":"multipart/form-data"}})}let g={series:1,card:n.value};await K.post("http://localhost:5000/card/add",g).then(C=>{console.log(C.data),alert("新卡片已添加"),J("close",""),J("updateCard",C.data),Q()})}}function F(){n.value.id===void 0&&(n.value.id=O.max),n.value.roundEffect=B.value,n.value.instantEffect=S.value,n.value.comboEffect=$.value,n.value.image=`/images/card/icon/1_${n.value.id}.png`,n.value.fullimage=`/images/card/image/1_${n.value.id}.png`,document.getElementById("spreadIndex").value===null&&(n.value.spread={id:parseInt(document.getElementById("spreadIndex").value),image:`/images/card/image/${n.value.id}.png`});let f=[];v.value.forEach(i=>{f.push(parseInt(i.id))}),n.value.tag=f;let l={id:n.value.id,name:n.value.name,rarity:n.value.rarity,image:n.value.image,instantEffect:n.value.instantEffect,roundEffect:n.value.roundEffect,comboEffect:n.value.comboEffect,PointMax:parseInt(n.value.PointMax),PointEnter:parseInt(n.value.PointEnter),PointConsume:parseInt(n.value.PointConsume),PointGet:parseInt(n.value.PointGet),tag:n.value.tag,fullimage:n.value.fullimage,keyword:n.value.keyword,...n.value.spread?{spread:n.value.spread}:{}};n.value=l,console.log(n.value)}function L(f){I.value=f}return j({setFunc:L}),(f,l)=>(a(),o("div",Be,[R(xe,{name:"step",tag:"div",class:"flex flex-row"},{default:ee(()=>[s(c)===1?(a(),o("div",Se,[e("div",Ne,[e("div",je,[l[19]||(l[19]=e("span",{class:"text-lg"},"卡片名稱:",-1)),e("input",{type:"text",class:"selfInput",placeholder:"卡片名子",onChange:l[0]||(l[0]=i=>s(n).name=i.target.value)},null,32)]),e("div",De,[l[20]||(l[20]=e("span",{class:"text-lg mr-1"},"卡片編號:",-1)),e("span",null,x(T.max),1)]),e("div",Pe,[l[21]||(l[21]=e("span",{class:"text-lg"},"稀有度:",-1)),(a(),o(b,null,y(3,i=>e("div",null,[e("input",{type:"radio",name:"rarity",value:i,onChange:l[1]||(l[1]=g=>s(n).rarity=parseInt(g.target.value))},null,40,Fe),e("span",null,x(i+"星"),1)])),64))]),e("div",Le,[l[22]||(l[22]=e("span",{class:"text-lg"},"縮圖:",-1)),e("button",{onClick:l[2]||(l[2]=i=>M("iconInput")),class:"max-w-[100px] addBtn"},"上傳"),e("input",{type:"file",id:"iconInput",class:"hidden",accept:"image/jpeg, image/png, image/jpg",onChange:l[3]||(l[3]=()=>U("iconInput"))},null,32),s(w)!==null?(a(),o("img",{key:0,src:s(w).file,alt:"縮圖",class:"max-w-[100px] max-h-[100px]"},null,8,Te)):p("",!0)])]),e("div",Ke,[e("div",Oe,[l[23]||(l[23]=e("span",{class:"text-lg"},"全身圖:",-1)),e("button",{onClick:l[4]||(l[4]=i=>M("imageInput")),class:"max-w-[100px] addBtn"},"上傳"),e("input",{type:"file",id:"imageInput",class:"hidden",accept:"image/jpeg, image/png, image/jpg",onChange:l[5]||(l[5]=()=>U("imageInput"))},null,32),s(E)!==null?(a(),o("img",{key:0,src:s(E).file,alt:"縮圖",class:"max-w-[200px] max-h-[300px]"},null,8,Je)):p("",!0)]),e("div",null,[e("button",{class:"addBtn pl-2 pr-2",onClick:V},"下一步")])])])):p("",!0),s(c)===2?(a(),o("div",Me,[e("div",Ue,[e("div",Ve,[e("div",Ae,[l[24]||(l[24]=e("span",{class:"text-lg"},"即時效果:",-1)),e("button",{class:"addBtn ml-3 px-3",onClick:l[6]||(l[6]=i=>A("instant"))},"添加"),s(S).length>1?(a(),o("button",{key:0,class:"addBtn ml-3 px-3",onClick:l[7]||(l[7]=i=>q("instant"))},"刪除")):p("",!0)]),(a(!0),o(b,null,y(s(S),(i,g)=>z((a(),o("input",{type:"text",class:"selfInput mt-1 mb-1",placeholder:"即使效果","onUpdate:modelValue":C=>s(S)[g]=C},null,8,qe)),[[Z,s(S)[g]]])),256))]),e("div",Ge,[e("div",Re,[l[25]||(l[25]=e("span",{class:"text-lg"},"回合效果:",-1)),e("button",{class:"addBtn ml-3 px-3",onClick:l[8]||(l[8]=i=>A("round"))},"添加"),s(B).length>1?(a(),o("button",{key:0,class:"addBtn ml-3 px-3",onClick:l[9]||(l[9]=i=>q("round"))},"刪除")):p("",!0)]),(a(!0),o(b,null,y(s(B),(i,g)=>z((a(),o("input",{type:"text",class:"selfInput mt-1 mb-1 whitespace-pre-wrap",placeholder:`回合效果${g+1}`,"onUpdate:modelValue":C=>s(B)[g]=C},null,8,He)),[[Z,s(B)[g]]])),256))]),e("div",ze,[e("div",Qe,[l[26]||(l[26]=e("span",{class:"text-lg"},"連動效果:",-1)),e("button",{class:"addBtn ml-3 px-3",onClick:l[10]||(l[10]=i=>A("combo"))},"添加"),s($).length>1?(a(),o("button",{key:0,class:"addBtn ml-3 px-3",onClick:l[11]||(l[11]=i=>q("combo"))},"刪除")):p("",!0)]),(a(!0),o(b,null,y(s($),(i,g)=>z((a(),o("textarea",{class:"selfInput mt-1 mb-1 min-h-[25px] max-h-[50px]",placeholder:`連動效果${g+1}`,"onUpdate:modelValue":C=>s($)[g]=C},null,8,We)),[[Z,s($)[g]]])),256))])]),e("div",Xe,[e("div",Ye,[l[28]||(l[28]=e("div",null,[e("span",null,"技能標籤")],-1)),e("div",null,[e("select",Ze,[l[27]||(l[27]=e("option",{value:0},x("請選擇"),-1)),(a(!0),o(b,null,y(s(I),i=>(a(),o("optgroup",{label:i.typeName},[(a(!0),o(b,null,y(i.data,g=>(a(),o("option",{value:g.id,class:"bg-amber-900"},x(g.name),9,tt))),256))],8,et))),256))]),e("button",{class:"rounded-sm bg-gray-600 min-w-[50px] text-white",onClick:l[12]||(l[12]=i=>W())},"新增")]),e("div",lt,[(a(!0),o(b,null,y(s(v),i=>(a(),o("div",nt,[e("span",null,x(i.id+" "+i.name),1),e("button",{class:"removeBtn",onClick:g=>G(i.id)},"移除",8,st)]))),256))])]),e("div",null,[e("button",{class:"addBtn pl-2 pr-2",onClick:V},"下一步")])])])):p("",!0),s(c)===3?(a(),o("div",at,[e("div",ot,[e("div",it,[l[29]||(l[29]=e("div",{class:"w-[120px]"},[e("span",null,"回合累積能量:")],-1)),e("input",{type:"number",id:"pointGet",class:"inputNum",min:1,max:8,required:"",onChange:l[13]||(l[13]=i=>s(n).PointGet=i.target.value)},null,32)]),e("div",dt,[l[30]||(l[30]=e("div",{class:"w-[120px]"},[e("span",null,"總儲存能量:")],-1)),e("input",{type:"number",id:"pointMax",class:"inputNum",min:1,max:8,required:"",onChange:l[14]||(l[14]=i=>s(n).PointMax=i.target.value)},null,32)]),e("div",ut,[l[31]||(l[31]=e("div",{class:"w-[120px]"},[e("span",null,"回合消耗能量:")],-1)),e("input",{type:"number",id:"pointConsume",class:"inputNum",min:1,max:8,required:"",onChange:l[15]||(l[15]=i=>s(n).PointConsume=i.target.value)},null,32)]),e("div",rt,[l[32]||(l[32]=e("div",{class:"w-[120px]"},[e("span",null,"進場能量:")],-1)),e("input",{type:"number",id:"pointEnter",class:"inputNum",min:1,max:8,required:"",onChange:l[16]||(l[16]=i=>s(n).PointEnter=i.target.value)},null,32)])]),e("div",ct,[e("div",ft,[l[33]||(l[33]=e("span",null,"卡片關鍵字:",-1)),e("input",{type:"text",class:"selfInput",placeholder:"輸入完成後按Enter",onKeydown:X},null,32),(a(!0),o(b,null,y(s(n).keyword,i=>(a(),o("span",null,x(i),1))),256))]),e("div",mt,[l[34]||(l[34]=e("span",null,"盤面圖:",-1)),e("button",{onClick:l[17]||(l[17]=i=>M("spreadInput")),class:"max-w-[100px] addBtn px-2"},"上傳"),e("input",{type:"file",id:"spreadInput",class:"hidden",accept:"image/jpeg, image/png, image/jpg",onChange:l[18]||(l[18]=()=>U("spreadInput"))},null,32),e("div",pt,[s(D)!==null?(a(),o("img",{key:0,src:s(D).file,alt:"盤面圖",class:"w-[240px]"},null,8,vt)):p("",!0)])]),e("div",{class:"my-2"},[l[35]||(l[35]=e("span",null,"圖片標示位置:",-1)),e("input",{type:"number",class:"selfInput",id:"spreadIndex",min:1,onClick:Y})]),e("div",{class:"mt-2"},[e("button",{class:"addBtn pl-2 pr-2",onClick:V},"下一步")])])])):p("",!0),s(c)===4||s(c)===5?(a(),o("div",xt,[e("div",gt,[e("div",wt,[e("div",bt,[s(n).rarity===1?(a(),o("span",yt,x(s(n).name),1)):p("",!0),s(n).rarity===2?(a(),o("span",ht,x(s(n).name),1)):p("",!0),s(n).rarity===3?(a(),o("span",_t,x(s(n).name),1)):p("",!0)]),s(n).rarity===1?(a(),o("div",kt,[e("img",{src:s(E).file,alt:s(n).name,class:"h-[40vh] min-w-[150px]"},null,8,$t)])):p("",!0),s(n).rarity===2?(a(),o("div",Ct,[e("img",{src:s(E).file,alt:s(n).name,class:"h-[40vh] min-w-[150px]"},null,8,Et)])):p("",!0),s(n).rarity===3?(a(),o("div",It,[e("img",{src:s(E).file,alt:s(n).name,class:"h-[40vh] min-w-[150px]"},null,8,Bt)])):p("",!0)]),e("div",St,[e("div",Nt,[e("div",jt,[s(n).rarity===1?(a(),o("div",Dt,l[36]||(l[36]=[e("span",null,"即時效果",-1)]))):p("",!0),s(n).rarity===2?(a(),o("div",Pt,l[37]||(l[37]=[e("span",null,"即時效果",-1)]))):p("",!0),s(n).rarity===3?(a(),o("div",Ft,l[38]||(l[38]=[e("span",null,"即時效果",-1)]))):p("",!0)]),e("div",Lt,[(a(!0),o(b,null,y(s(n).instantEffect,i=>(a(),o("span",Tt,"•"+x(i),1))),256))])]),e("div",Kt,[s(n).rarity===1?(a(),o("div",Ot,l[39]||(l[39]=[e("span",null,"回合效果",-1)]))):p("",!0),s(n).rarity===2?(a(),o("div",Jt,l[40]||(l[40]=[e("span",null,"回合效果",-1)]))):p("",!0),s(n).rarity===3?(a(),o("div",Mt,l[41]||(l[41]=[e("span",null,"回合效果",-1)]))):p("",!0),e("div",Ut,[(a(!0),o(b,null,y(s(n).roundEffect,i=>(a(),o("span",Vt,"•"+x(i),1))),256))])]),e("div",At,[s(n).rarity===1?(a(),o("div",qt,l[42]||(l[42]=[e("span",null,"連動效果",-1)]))):p("",!0),s(n).rarity===2?(a(),o("div",Gt,l[43]||(l[43]=[e("span",null,"連動效果",-1)]))):p("",!0),s(n).rarity===3?(a(),o("div",Rt,l[44]||(l[44]=[e("span",null,"連動效果",-1)]))):p("",!0),e("div",Ht,[(a(!0),o(b,null,y(s(n).comboEffect,i=>(a(),o("span",zt,"•"+x(i),1))),256))])])])]),e("div",{class:"w-5/6 mt-5 mx-auto"},[e("button",{class:"addBtn min-w-[100px] ml-2",onClick:V},"儲存")])])):p("",!0)]),_:1})]))}},Wt=ce(Qt,[["__scopeId","data-v-63d6fa32"]]),Xt={class:"main"},Yt={class:"w-4/5 mx-auto mb-2"},Zt={class:"flex flex-row"},el={class:"w-4/5 mx-auto flex flex-row justify-evenly"},tl={key:0,class:"w-1/2 min-h-[500px] flex flex-row"},ll={class:"CardImage w-1/2"},nl={class:"text-white font-bold text-xl"},sl=["src"],al={class:"Details flex flex-col w-1/2 mt-5 [&>div]:mb-5"},ol={class:"flex flex-row"},il={class:"mb-3 flex flex-col"},dl=["onKeydown"],ul={class:"flex flex-row"},rl={class:"mb-3 flex flex-col"},cl=["onKeydown"],fl={class:"flex flex-row"},ml={class:"mb-3 flex flex-col"},pl=["onKeydown"],vl={class:"flex flex-col"},xl=["onClick"],gl=["src"],wl={key:0,class:"text-red-500 text-md"},bl={key:1,class:"text-white text-md"},yl={key:1,class:"w-2/5 pl-3 right mt-5 h-[500px] relative"},hl={key:2,class:"w-2/5 pl-3 right mt-5 h-[500px] relative"},_l={class:"flex-col"},kl={class:"mb-3"},$l=["value"],Cl={key:0},El={class:"colorSelect w-[150px]",id:"tagSelect"},Il=["label"],Bl=["value"],Sl={key:1},Nl={class:"mb-2 flex-col"},jl={class:"overflow-y-scroll hiddenScrollbar"},Dl={class:"flex flex-col"},Pl={class:"flex flex-row my-1"},Fl={class:"w-1/5"},Ll={class:"text-white"},Tl={class:"w-2/5"},Kl={class:"text-white"},Ol={class:"w-2/5"},Jl=["id","onClick"],Ml={key:3,class:"w-2/5 pl-3 right mt-5 h-[500px] relative"},Ul={key:4,class:"w-2/5 pl-3 right mt-5 h-[500px] relative"},Vl={class:"my-5"},Al={class:"flex flex-row"},ql={class:"mb-3 flex flex-col"},Gl=["onKeydown"],Rl={class:"my-5"},Hl={class:"flex flex-row my-1"},zl={class:"mb-3 flex flex-col"},Ql=["onKeydown"],Wl={class:"my-5"},Xl={class:"flex flex-row my-1"},Yl={class:"mb-3 flex flex-col"},Zl=["onKeydown"],en={key:5,class:"w-2/5 pl-3 right mt-5 h-[500px] relative"},tn={class:"w-3/5 mx-auto my-3"},ln={class:"slide w-4/5 mx-auto mt-3 pt-3"},nn={class:"ml-5 mb-3"},sn={class:"flex flex-row"},an=["onClick"],on=["src"],dn={key:0,class:"w-[100%] text-center bg-amber-900 text-white rounded-md"},un={key:1,class:"w-[100%] text-center bg-slate-500 text-white rounded-md"},rn={key:2,class:"w-[100%] text-center bg-yellow-600 text-white rounded-md"},cn={class:"overlay",id:"overlay"},fn={class:"popup max-[500px]:w-[80%] max-[500px]:min-w-[200px]"};let pe=_(null);const mn={name:"App",components:{Carousel:me,Slide:fe,Pagination:Ie,Navigation:Ee},methods:{slideItem:function(T,j){if(T.target.value>j||T.target.value<0)alert("該編號卡片資料沒有找到!!");else{let P=T.target.value;pe.value.data.slideTo(P-1)}}},data(){}},pn=Object.assign(mn,{setup(T){let j=[],P=[],O=_(1),n=_([]),I=_([]),c=_([]),w=_(1),E="",D=_(null),v=_({}),B=_([{name:"基本資訊",mode:"edit_basic"},{name:"效果敘述",mode:"edit_description"},{name:"技能標籤",mode:"edit_tag"},{name:"關鍵字",mode:"edit_keyword"},{name:"圖片管理",mode:"edit_img"},{name:"刪除卡片",mode:"delete"}]),$=_("edit_basic");const S=ye("frontpath",""),J=_(S),Q=be();function M(){K.post("http://localhost:5000/card/get",{get:O.value}).then(u=>{if(console.log(u.data),j=u.data.card,P=u.data.func,u.data=="發生錯誤"){console.log("沒有發現相關資料");return}I.value=JSON.parse(JSON.stringify(P)),c.value=JSON.parse(JSON.stringify(j)),G(1)}).catch(u=>{alert("伺服器尚未開啟請稍後再試!!"),window.location=window.location.origin+"/"})}function U(u){let t=document.getElementById("series"+u);t.classList.contains("clicked")?t.classList.remove("clicked"):t.classList.add("clicked"),O.value=parseInt(u),M()}function A(u){n.value=n.value.filter((r,m)=>m!==u);let t=c.value.find(r=>r.id===parseInt(w.value)).tag;c.value.find(r=>r.id===parseInt(w.value)).tag=t.filter((r,m)=>m!==u),console.log(c.value.find(r=>r.id===parseInt(w.value)))}function q(){var u=parseInt(document.getElementById("tagSelect").value),t={};I.value.forEach(r=>{let m=r.data.find(h=>h.id===u);m!==void 0&&(t=m)}),!(n.value.includes(t)||u===0)&&(n.value.push(t),n.value=n.value.sort((r,m)=>r.id-m.id),c.value.find(r=>r.id===w.value).tag.push(u),c.value.find(r=>r.id===w.value).tag=c.value.find(r=>r.id===w.value).tag.sort((r,m)=>r-m),console.log(j.find(r=>r.id===w.value).tag),console.log(c.value.find(r=>r.id===w.value).tag))}function W(){if(confirm("將會儲存你所做的所有更改，如果確定覆蓋則按確定"))try{let u={getId:O.value,newData:c.value};console.log(u),K.post("http://localhost:5000/card/edit",u).then(t=>{console.log(t),alert(t.data),j=JSON.parse(JSON.stringify(c.value))})}catch(u){console.log(u)}}function G(u){w.value=u,v.value=c.value.find(t=>t.id===w.value),n.value=[],v.value.tag.forEach(t=>{P.forEach(r=>{let m=r.data.find(h=>h.id===t);m!==void 0&&n.value.push(m)})})}function X(){let u={series:O.value,id:w.value};K.post("http://localhost:5000/card/delete",u).then(t=>{console.log(t),c.value=c.value.filter(r=>r.id!==w.value),console.log(c.value),j=JSON.parse(JSON.stringify(c.value)),G(c.value[0].id),alert("卡片刪除成功!")})}function Y(u){if(E=u.target.value,console.log(E),E===""){I.value=P;return}let t=[];P.forEach(r=>{let m=[];if(r.data.forEach(h=>{h.name.includes(E)&&m.push(h)}),m.length!==0){console.log(m);let h=r;h.data=m,t.push(h)}}),t.length!==0?I.value=t:I.value=[]}function V(){let u=j.find(r=>r.id===w.value);if(u==null)return;let t=JSON.parse(JSON.stringify(u));n.value=[],t.tag.forEach(r=>{P.forEach(m=>{let h=m.data.find(H=>H.id===r);h!==void 0&&n.value.push(h)})}),v.value=t,Object.assign(u,t)}function F(u){u.target.parentElement.querySelector("textarea").classList.remove("hidden"),u.target.classList.add("hidden")}function L(u,t,r=void 0){if(console.log(u.key),u.key==="Enter"){switch(t){case"instant":c.value[w.value-1].instantEffect[r]=u.target.value;break;case"round":c.value[w.value-1].roundEffect[r]=u.target.value;break;case"combo":c.value[w.value-1].comboEffect[r]=u.target.value;break}console.log(c.value.find(h=>h.id===w.value)),u.target.parentElement.querySelector("span").classList.remove("hidden"),u.target.classList.add("hidden");return}if(u.key,u.key==="Delete")switch(t){case"instant":break;case"round":c.value.find(m=>m.id===w.value).roundEffect=c.value.find(m=>m.id===w.value).roundEffect.filter((m,h)=>h!==r);break;case"combo":c.value.find(m=>m.id===w.value).comboEffect=c.value.find(m=>m.id===w.value).comboEffect.filter((m,h)=>h!==r);break}}function f(u){let t=c.value.find(r=>r.id===w.value);switch(u){case"round":t.roundEffect.push("回合效果");break;case"instant":t.instantEffect.push("即時效果");break;case"combo":t.comboEffect.push("連動效果");break}}function l(u){let t=c.value.find(r=>r.id===w.value);switch(u){case"round":if(t.roundEffect.length===1)break;t.roundEffect=t.roundEffect.filter((r,m)=>m!==t.roundEffect.length-1);break;case"instant":if(t.instantEffect.length===1)break;t.instantEffect=t.instantEffect.filter((r,m)=>m!==t.instantEffect.length-1);break;case"combo":if(t.comboEffect.length===1)break;t.comboEffect=t.comboEffect.filter((r,m)=>m!==t.comboEffect.length-1);break}}function i(){document.getElementById("overlay").style.display="block",D.value.setFunc(I.value)}function g(){document.getElementById("overlay").style.display="none"}function C(u){$.value=u}function ve(u){j=u,c.value=JSON.parse(JSON.stringify(j))}return ge(v,(u,t)=>{c.value[u.id-1]=u},{deep:!0}),_e("close",g),we(()=>{window.location=window.location.origin+`/${Q.public.projectName}/`,M()}),(u,t)=>{var r,m,h,H,te,le,ne,se,ae,oe,ie,de,ue;return a(),o("div",Xt,[e("div",Yt,[t[22]||(t[22]=e("span",{class:"text-white text-xl"},"系列",-1)),e("div",Zt,[e("button",{class:"addBtn mr-5 w-[100px]",onClick:t[0]||(t[0]=d=>U(1)),id:"series1"},"晨曦塔"),e("button",{class:"addBtn mr-5 w-[100px]",onClick:t[1]||(t[1]=d=>U(2)),id:"series2"},"測試塔")])]),e("div",el,[s(v)!==void 0?(a(),o("div",tl,[e("div",ll,[e("span",nl,x(s(v).name),1),e("img",{src:J.value+s(v).fullimage,alt:"全身圖",class:"max-h-[500px]"},null,8,sl)]),z(e("div",al,[e("div",null,[e("div",ol,[t[23]||(t[23]=e("span",{class:"standwardLabel"},"即時效果",-1)),e("button",{class:"addBtn ml-5",onClick:t[2]||(t[2]=d=>f("instant"))},"新增"),((m=(r=s(v))==null?void 0:r.instantEffect)==null?void 0:m.length)>1?(a(),o("button",{key:0,class:"addBtn ml-5",onClick:t[3]||(t[3]=d=>l("instant"))},"刪除")):p("",!0)]),(a(!0),o(b,null,y(s(v).instantEffect,(d,k)=>(a(),o("div",il,[e("span",{class:"text-white font-bold",onDblclick:F},x(d),33),e("textarea",{class:"hidden bg-gray-600 text-white h-auto rounded-sm min-h-[50px]",onKeydown:N=>L(N,"instant",k)},x(d),41,dl)]))),256))]),e("div",null,[e("div",ul,[t[24]||(t[24]=e("span",{class:"standwardLabel"},"回合效果",-1)),e("button",{class:"addBtn ml-5",onClick:t[4]||(t[4]=d=>f("round"))},"新增"),((H=(h=s(v))==null?void 0:h.roundEffect)==null?void 0:H.length)>1?(a(),o("button",{key:0,class:"addBtn ml-5",onClick:t[5]||(t[5]=d=>l("round"))},"刪除")):p("",!0)]),(a(!0),o(b,null,y(s(v).roundEffect,(d,k)=>(a(),o("div",rl,[e("span",{class:"text-white font-bold",onDblclick:F},x(d),33),e("textarea",{class:"hidden bg-gray-600 text-white h-auto rounded-sm min-h-[50px]",onKeydown:N=>L(N,"round",k)},x(d),41,cl)]))),256))]),e("div",null,[e("div",fl,[t[25]||(t[25]=e("span",{class:"standwardLabel"},"連動效果",-1)),e("button",{class:"addBtn ml-5",onClick:t[6]||(t[6]=d=>f("combo"))},"新增"),((le=(te=s(v))==null?void 0:te.comboEffect)==null?void 0:le.length)>1?(a(),o("button",{key:0,class:"addBtn ml-5",onClick:t[7]||(t[7]=d=>l("combo"))},"刪除")):p("",!0)]),(a(!0),o(b,null,y(s(v).comboEffect,(d,k)=>(a(),o("div",ml,[e("span",{class:"text-white font-bold",onDblclick:F},x(d),33),e("textarea",{class:"hidden bg-gray-600 text-white h-auto rounded-sm min-h-[50px]",onKeydown:N=>L(N,"combo",k)},x(d),41,pl)]))),256))])],512),[[ke,!1]]),e("div",null,[t[26]||(t[26]=e("span",{class:"text-red-700 text-lg"},"選擇要編輯的項目:",-1)),e("div",vl,[(a(!0),o(b,null,y(s(B),d=>(a(),o("div",{class:"my-2 flex flex-row cursor-pointer",onClick:k=>C(d.mode)},[e("img",{src:J.value+"/images/arrow_right.png",width:"20",height:"20"},null,8,gl),d.mode==="delete"?(a(),o("span",wl,x(d.name),1)):(a(),o("span",bl,x(d.name),1))],8,xl))),256))])])])):p("",!0),s($)=="edit_basic"?(a(),o("div",yl,[R($e,{card:s(v),"onUpdate:card":t[8]||(t[8]=d=>re(v)?v.value=d:v=d)},null,8,["card"])])):p("",!0),s($)=="edit_tag"?(a(),o("div",hl,[e("div",_l,[t[29]||(t[29]=e("span",{class:"standwardLabel"},"自身技能標籤",-1)),e("div",kl,[e("input",{type:"text",value:s(E),placeholder:"技能關鍵字",onInput:t[9]||(t[9]=d=>Y(d)),class:"colorSelect"},null,40,$l)]),((ne=s(I))==null?void 0:ne.length)!==0?(a(),o("div",Cl,[e("select",El,[t[27]||(t[27]=e("option",{value:0},x("請選擇"),-1)),(a(!0),o(b,null,y(s(I),d=>(a(),o("optgroup",{label:d.typeName},[(a(!0),o(b,null,y(d.data,k=>(a(),o("option",{value:k.id,class:"bg-amber-900"},x(k.name),9,Bl))),256))],8,Il))),256))]),e("button",{class:"rounded-sm bg-gray-600 min-w-[50px] text-white",onClick:t[10]||(t[10]=d=>q())},"新增")])):(a(),o("div",Sl,t[28]||(t[28]=[e("span",{class:"text-yellow-500 font-bold text-lg"},"沒有找到匹配技能標籤",-1)])))]),e("div",Nl,[e("div",jl,[e("div",Dl,[(a(!0),o(b,null,y(s(n),(d,k)=>(a(),o("div",Pl,[e("div",Fl,[e("span",Ll,x(d.id),1)]),e("div",Tl,[e("span",Kl,x(d.name),1)]),e("div",Ol,[e("button",{class:"removeBtn",id:"btns"+k,onClick:N=>A(k)},"移除",8,Jl)])]))),256))])])])])):p("",!0),s($)=="edit_keyword"?(a(),o("div",Ml,[R(Ce,{card:s(v),"onUpdate:card":t[11]||(t[11]=d=>re(v)?v.value=d:v=d)},null,8,["card"])])):p("",!0),s($)=="edit_description"?(a(),o("div",Ul,[t[33]||(t[33]=e("div",null,[e("span",{class:"text-amber-800 text-[18px]"},"效果敘述")],-1)),e("div",Vl,[e("div",Al,[t[30]||(t[30]=e("span",{class:"standwardSubLabel"},"即時效果",-1)),e("button",{class:"addBtn ml-5",onClick:t[12]||(t[12]=d=>f("instant"))},"新增"),((ae=(se=s(v))==null?void 0:se.instantEffect)==null?void 0:ae.length)>1?(a(),o("button",{key:0,class:"addBtn ml-5",onClick:t[13]||(t[13]=d=>l("instant"))},"刪除")):p("",!0)]),(a(!0),o(b,null,y(s(v).instantEffect,(d,k)=>(a(),o("div",ql,[e("span",{class:"text-white font-bold",onDblclick:F},x(d),33),e("textarea",{class:"hidden bg-gray-600 text-white h-auto rounded-sm min-h-[50px]",onKeydown:N=>L(N,"instant",k)},x(d),41,Gl)]))),256))]),e("div",Rl,[e("div",Hl,[t[31]||(t[31]=e("span",{class:"standwardSubLabel"},"回合效果",-1)),e("button",{class:"addBtn ml-5",onClick:t[14]||(t[14]=d=>f("round"))},"新增"),((ie=(oe=s(v))==null?void 0:oe.roundEffect)==null?void 0:ie.length)>1?(a(),o("button",{key:0,class:"addBtn ml-5",onClick:t[15]||(t[15]=d=>l("round"))},"刪除")):p("",!0)]),(a(!0),o(b,null,y(s(v).roundEffect,(d,k)=>(a(),o("div",zl,[e("span",{class:"text-white font-bold",onDblclick:F},x(d),33),e("textarea",{class:"hidden bg-gray-600 text-white h-auto rounded-sm min-h-[50px]",onKeydown:N=>L(N,"round",k)},x(d),41,Ql)]))),256))]),e("div",Wl,[e("div",Xl,[t[32]||(t[32]=e("span",{class:"standwardSubLabel"},"連動效果",-1)),e("button",{class:"addBtn ml-5",onClick:t[16]||(t[16]=d=>f("combo"))},"新增"),((ue=(de=s(v))==null?void 0:de.comboEffect)==null?void 0:ue.length)>1?(a(),o("button",{key:0,class:"addBtn ml-5",onClick:t[17]||(t[17]=d=>l("combo"))},"刪除")):p("",!0)]),(a(!0),o(b,null,y(s(v).comboEffect,(d,k)=>(a(),o("div",Yl,[e("span",{class:"text-white font-bold",onDblclick:F},x(d),33),e("textarea",{class:"hidden bg-gray-600 text-white h-auto rounded-sm min-h-[50px]",onKeydown:N=>L(N,"combo",k)},x(d),41,Zl)]))),256))])])):p("",!0),s($)=="delete"?(a(),o("div",en,[t[35]||(t[35]=e("div",null,[e("span",{class:"text-amber-800 text-[18px]"},"刪除卡片")],-1)),e("div",{class:"flex flex-col mt-2 justify-start"},[t[34]||(t[34]=e("span",{class:"text-white"},"經過此操作後，該筆資料將永久刪除，按下下面按鈕以確認操作",-1)),e("button",{class:"removeBtn w-[100px]",onClick:X},"確認刪除")])])):p("",!0)]),e("div",tn,[e("button",{class:"removeBtn min-w-[150px] mb-3",onClick:t[18]||(t[18]=d=>W())},"儲存"),e("button",{class:"removeBtn min-w-[150px] mb-3",onClick:t[19]||(t[19]=d=>V())},"還原")]),e("div",ln,[e("div",nn,[t[36]||(t[36]=e("span",{class:"text-white"},"請輸入要卡片編號:",-1)),e("div",sn,[e("input",{type:"number",class:"w-[100px] rounded-md text-center",onChange:t[20]||(t[20]=d=>u.slideItem(d,s(c).length))},null,32),e("button",{class:"addBtn ml-3 px-3",onClick:t[21]||(t[21]=()=>i())},"添加卡片")])]),R(s(me),{"wrap-around":!0,"items-to-show":5,ref_key:"cardSlide",ref:pe},{default:ee(()=>[(a(!0),o(b,null,y(s(c),(d,k)=>(a(),he(s(fe),{key:k},{default:ee(()=>[e("div",{class:"flex-col [&>span]:block cursor-pointer",onClick:N=>G(d.id)},[e("img",{src:J.value+d.image,width:"160",alt:"not found"},null,8,on),d.rarity===1?(a(),o("span",dn,x(d.id),1)):p("",!0),d.rarity===2?(a(),o("span",un,x(d.id),1)):p("",!0),d.rarity===3?(a(),o("span",rn,x(d.id),1)):p("",!0)],8,an)]),_:2},1024))),128))]),_:1},512)]),e("div",cn,[e("div",fn,[e("div",{class:"close",onClick:g},"✖"),R(Wt,{ref_key:"popup",ref:D,max:s(c).length+1,func:s(I),onClose:g,onUpdateCard:ve},null,8,["max","func"])])])])}}}),yn=ce(pn,[["__scopeId","data-v-ce7fad47"]]);export{yn as default};
